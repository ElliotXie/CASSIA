<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASSIA Batch Analysis Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>

    :root {
        --primary: #0d9488;
        --primary-light: #14b8a6;
        --primary-dark: #0f766e;
        --secondary: #059669;
        --accent: #f59e0b;
        --accent-light: #fbbf24;
        --background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 50%, #f0fdf4 100%);
        --surface: rgba(255, 255, 255, 0.85);
        --surface-hover: rgba(255, 255, 255, 0.95);
        --text-primary: #134e4a;
        --text-secondary: #64748b;
        --text-muted: #94a3b8;
        --border: rgba(13, 148, 136, 0.15);
        --shadow: 0 8px 32px rgba(13, 148, 136, 0.12);
        --shadow-hover: 0 12px 40px rgba(13, 148, 136, 0.2);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
        background: var(--background);
        min-height: 100vh;
        color: var(--text-primary);
        line-height: 1.6;
    }

    .container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
    }

    /* Header */
    .report-header {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        padding: 40px;
        border-radius: 24px;
        margin-bottom: 30px;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
    }

    .report-header::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
        pointer-events: none;
    }

    .header-content {
        position: relative;
        z-index: 1;
    }

    .report-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 8px;
        letter-spacing: -0.5px;
    }

    .report-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        font-weight: 400;
    }

    .report-meta {
        display: flex;
        gap: 24px;
        margin-top: 20px;
        flex-wrap: wrap;
    }

    .meta-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 16px;
        border-radius: 12px;
        font-size: 0.9rem;
        backdrop-filter: blur(10px);
    }

    /* Stats Bar */
    .stats-bar {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 16px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        text-align: center;
        box-shadow: var(--shadow);
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        line-height: 1;
    }

    .stat-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
        margin-top: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Controls */
    .controls-bar {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 30px;
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        align-items: center;
        box-shadow: var(--shadow);
    }

    .search-box {
        flex: 1;
        min-width: 250px;
        position: relative;
    }

    .search-box input {
        width: 100%;
        padding: 12px 16px 12px 44px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 1rem;
        background: white;
        color: var(--text-primary);
        transition: all 0.3s ease;
    }

    .search-box input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(13, 148, 136, 0.1);
    }

    .search-box svg {
        position: absolute;
        left: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
    }

    .filter-select {
        padding: 12px 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 0.9rem;
        background: white;
        color: var(--text-primary);
        cursor: pointer;
        min-width: 140px;
        transition: all 0.3s ease;
    }

    .filter-select:focus {
        outline: none;
        border-color: var(--primary);
    }

    .btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 12px 20px;
        border: none;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(13, 148, 136, 0.3);
    }

    .btn-secondary {
        background: white;
        color: var(--text-primary);
        border: 2px solid var(--border);
    }

    .btn-secondary:hover {
        border-color: var(--primary);
        color: var(--primary);
    }

    /* Cluster Grid */
    .cluster-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
        gap: 24px;
    }

    .cluster-card {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 20px;
        padding: 24px;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .cluster-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-hover);
        border-color: var(--primary-light);
        background: var(--surface-hover);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
    }

    .cluster-name {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-primary);
        line-height: 1.3;
    }

    .card-badges {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        justify-content: flex-end;
    }

    .badge {
        padding: 4px 10px;
        border-radius: 8px;
        font-size: 0.75rem;
        font-weight: 600;
        white-space: nowrap;
    }

    .badge-markers {
        background: linear-gradient(135deg, var(--primary-light), var(--primary));
        color: white;
    }

    .badge-iterations {
        background: linear-gradient(135deg, var(--accent-light), var(--accent));
        color: white;
    }

    .badge-score {
        font-weight: 600;
    }

    .score-high {
        background: linear-gradient(135deg, #10b981, #059669) !important;
        color: white;
    }

    .score-medium {
        background: linear-gradient(135deg, #86efac, #4ade80) !important;
        color: #166534;
    }

    .score-low {
        background: linear-gradient(135deg, #ef4444, #dc2626) !important;
        color: white;
    }

    .card-main-type {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.08), rgba(5, 150, 105, 0.08));
        border-radius: 12px;
        padding: 16px;
        border-left: 4px solid var(--primary);
    }

    .main-type-label {
        font-size: 0.8rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: block;
        margin-bottom: 4px;
    }

    .main-type-value {
        font-size: 1.15rem;
        font-weight: 700;
        color: var(--primary-dark);
    }

    .card-section {
        padding: 0;
    }

    .section-label {
        font-size: 0.8rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .sub-types-list {
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .sub-types-list li {
        font-size: 0.9rem;
        color: var(--text-primary);
        padding-left: 16px;
        position: relative;
    }

    .sub-types-list li::before {
        content: '';
        position: absolute;
        left: 0;
        top: 8px;
        width: 6px;
        height: 6px;
        background: var(--secondary);
        border-radius: 50%;
    }

    .sub-types-list li.more {
        color: var(--text-muted);
        font-style: italic;
    }

    .sub-types-list li.more::before {
        background: var(--text-muted);
    }

    /* Ranked subtype colors with BACKGROUND - deeper = more likely */
    /* No bullet points - background color is sufficient */
    .sub-types-list li.rank-1 {
        background: rgba(13, 148, 136, 0.25);
        color: #0d9488;
        font-weight: 600;
        padding: 8px 12px;
        border-radius: 6px;
        border-left: 3px solid #0d9488;
        margin-bottom: 4px;
    }
    .sub-types-list li.rank-1::before {
        display: none;
    }

    .sub-types-list li.rank-2 {
        background: rgba(20, 184, 166, 0.15);
        color: #134e4a;
        padding: 8px 12px;
        border-radius: 6px;
        border-left: 3px solid #14b8a6;
        margin-bottom: 4px;
    }
    .sub-types-list li.rank-2::before {
        display: none;
    }

    .sub-types-list li.rank-3 {
        background: rgba(94, 234, 212, 0.12);
        color: #64748b;
        padding: 8px 12px;
        border-radius: 6px;
        border-left: 3px solid #5eead4;
        margin-bottom: 4px;
    }
    .sub-types-list li.rank-3::before {
        display: none;
    }

    .empty-field {
        color: var(--text-muted);
        font-style: italic;
        font-size: 0.9rem;
    }

    .card-field {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 0.85rem;
        color: var(--text-secondary);
    }

    .card-field .field-icon {
        color: var(--primary);
        flex-shrink: 0;
        margin-top: 2px;
    }

    .card-field .field-label {
        font-weight: 600;
        white-space: nowrap;
    }

    .card-meta {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 12px;
        background: rgba(100, 116, 139, 0.05);
        border-radius: 10px;
    }

    .meta-row {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .meta-item svg {
        color: var(--primary);
    }

    .card-markers {
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .markers-label {
        font-weight: 600;
    }

    .markers-preview {
        color: var(--text-muted);
        word-break: break-word;
    }

    .view-analysis-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 14px 20px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: auto;
    }

    .view-analysis-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(13, 148, 136, 0.3);
    }

    /* Modal */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(8px);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        padding: 20px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
        display: flex;
        opacity: 1;
    }

    .modal-container {
        background: white;
        border-radius: 24px;
        max-width: 900px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
        animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .modal-content {
        display: none;
    }

    .modal-content.active {
        display: block;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: 28px 32px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
    }

    .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 4px;
    }

    .modal-subtitle {
        font-size: 1rem;
        opacity: 0.9;
    }

    .modal-close {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 1.8rem;
        width: 40px;
        height: 40px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
    }

    .modal-close:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
    }

    .modal-body {
        padding: 28px 32px;
        max-height: calc(90vh - 120px);
        overflow-y: auto;
    }

    .markers-full {
        background: rgba(13, 148, 136, 0.05);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
        border-left: 4px solid var(--primary);
    }

    .markers-full h4 {
        font-size: 0.85rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .markers-text {
        font-size: 0.9rem;
        color: var(--text-primary);
        word-break: break-word;
        line-height: 1.7;
    }

    .modal-section {
        margin-bottom: 24px;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid var(--border);
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 16px 20px;
        font-size: 1.05rem;
        font-weight: 600;
        margin: 0;
    }

    .section-content {
        padding: 20px;
        background: white;
        font-size: 0.95rem;
        line-height: 1.8;
    }

    .annotation-section .section-title {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.1), rgba(13, 148, 136, 0.05));
        color: var(--primary-dark);
    }

    .validator-section .section-title {
        background: linear-gradient(135deg, rgba(5, 150, 105, 0.1), rgba(5, 150, 105, 0.05));
        color: #047857;
    }

    .formatting-section .section-title {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
        color: #b45309;
    }

    .scoring-section .section-title {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
        color: #4338ca;
    }

    .validation-status {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 16px;
        border-radius: 10px;
        font-weight: 600;
        margin-bottom: 12px;
    }

    .validation-status.passed {
        background: rgba(5, 150, 105, 0.1);
        color: #047857;
    }

    .validation-status.failed {
        background: rgba(239, 68, 68, 0.1);
        color: #dc2626;
    }

    .validator-content {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .json-summary {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .summary-field {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .summary-field .field-label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--accent);
        font-weight: 600;
    }

    .summary-field .field-value {
        color: var(--text-primary);
    }

    .summary-field .main-type {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-dark);
    }

    .type-list {
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .type-list li {
        padding: 8px 12px;
        background: rgba(13, 148, 136, 0.05);
        border-radius: 8px;
        font-size: 0.9rem;
    }

    .type-list li.empty {
        color: var(--text-muted);
        font-style: italic;
        background: rgba(100, 116, 139, 0.05);
    }

    /* Ranked subtypes in modal type-list */
    .type-list li.rank-1 {
        background: rgba(13, 148, 136, 0.15);
        color: #0d9488;
        font-weight: 600;
        border-left: 3px solid #0d9488;
    }

    .type-list li.rank-2 {
        background: rgba(20, 184, 166, 0.12);
        color: #134e4a;
        border-left: 3px solid #14b8a6;
    }

    .type-list li.rank-3 {
        background: rgba(94, 234, 212, 0.12);
        color: #64748b;
        border-left: 3px solid #5eead4;
    }

    /* Merged cell type groupings styles */
    .merged-section {
        margin-top: 8px;
    }

    .merged-groupings {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .merged-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .merged-label {
        font-size: 0.7rem;
        font-weight: 600;
        color: var(--text-secondary);
        text-transform: uppercase;
        min-width: 55px;
    }

    .merged-tag {
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 500;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }

    .merged-broad {
        background: rgba(13, 148, 136, 0.15);
        color: #0d9488;
        border: 1px solid rgba(13, 148, 136, 0.3);
    }

    .merged-detailed {
        background: rgba(5, 150, 105, 0.15);
        color: #059669;
        border: 1px solid rgba(5, 150, 105, 0.3);
    }

    .merged-specific {
        background: rgba(245, 158, 11, 0.15);
        color: #b45309;
        border: 1px solid rgba(245, 158, 11, 0.3);
    }

    /* Merged groupings section in modal */
    .merged-groupings-section .section-title {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(139, 92, 246, 0.05));
        color: #7c3aed;
    }

    .merged-detail-grid {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .merged-detail-item {
        display: flex;
        flex-direction: column;
        gap: 4px;
        padding: 12px;
        background: rgba(139, 92, 246, 0.05);
        border-radius: 8px;
        border-left: 3px solid #7c3aed;
    }

    .merged-level {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #7c3aed;
        font-weight: 600;
    }

    .merged-value {
        font-size: 0.95rem;
        color: var(--text-primary);
    }

    .json-raw {
        background: #1e293b;
        color: #e2e8f0;
        padding: 16px;
        border-radius: 8px;
        font-size: 0.85rem;
        overflow-x: auto;
    }

    .step-header {
        color: var(--primary);
        font-size: 1rem;
        margin-top: 20px;
        margin-bottom: 10px;
        padding-bottom: 6px;
        border-bottom: 2px solid rgba(13, 148, 136, 0.2);
    }

    .section-content h2, .section-content h3, .section-content h4 {
        color: var(--text-primary);
        margin-top: 16px;
        margin-bottom: 8px;
    }

    .section-content ul {
        margin: 12px 0;
        padding-left: 24px;
    }

    .section-content li {
        margin-bottom: 6px;
    }

    .section-content p {
        margin-bottom: 12px;
    }

    .section-content strong {
        color: var(--text-primary);
    }

    /* Print Styles */
    @media print {
        .controls-bar,
        .view-analysis-btn,
        .modal-overlay {
            display: none !important;
        }

        .cluster-card {
            break-inside: avoid;
            box-shadow: none;
            border: 1px solid #ddd;
        }

        .report-header {
            background: var(--primary) !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .container {
            padding: 12px;
        }

        .report-header {
            padding: 24px;
            border-radius: 16px;
        }

        .report-title {
            font-size: 1.8rem;
        }

        .cluster-grid {
            grid-template-columns: 1fr;
        }

        .controls-bar {
            flex-direction: column;
        }

        .search-box {
            width: 100%;
        }

        .filter-select {
            width: 100%;
        }

        .modal-container {
            max-height: 95vh;
            border-radius: 16px;
        }

        .modal-header {
            padding: 20px;
        }

        .modal-body {
            padding: 20px;
        }
    }

    /* No results message */
    .no-results {
        text-align: center;
        padding: 60px 20px;
        color: var(--text-secondary);
    }

    .no-results svg {
        width: 64px;
        height: 64px;
        color: var(--text-muted);
        margin-bottom: 16px;
    }

    .no-results h3 {
        font-size: 1.2rem;
        margin-bottom: 8px;
        color: var(--text-primary);
    }
    
    </style>
</head>
<body>
    <div class="container">
        <header class="report-header">
            <div class="header-content">
                <h1 class="report-title">CASSIA Batch Analysis Report</h1>
                <p class="report-subtitle">Comprehensive Cell Type Annotation Analysis</p>
                <div class="report-meta">
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        2025-12-09 17:42:35
                    </span>
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        large intestine
                    </span>
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M2 12h20"></path>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                        human
                    </span>
                </div>
            </div>
        </header>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value">6</div>
                <div class="stat-label">Total Clusters</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="visible-count">6</div>
                <div class="stat-label">Showing</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">1</div>
                <div class="stat-label">Tissues</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">1</div>
                <div class="stat-label">Models</div>
            </div>
        </div>

        <div class="controls-bar">
            <div class="search-box">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" id="search-input" placeholder="Search clusters, cell types, markers...">
            </div>
            <select class="filter-select" id="filter-tissue" onchange="filterCards()">
                <option value="">All Tissues</option><option value="large intestine">large intestine</option>
            </select>
            <select class="filter-select" id="filter-species" onchange="filterCards()">
                <option value="">All Species</option><option value="human">human</option>
            </select>
            <select class="filter-select" id="filter-model" onchange="filterCards()">
                <option value="">All Models</option><option value="openai/gpt-5.1">openai/gpt-5.1</option>
            </select>
            <select class="filter-select" id="filter-provider" onchange="filterCards()">
                <option value="">All Providers</option><option value="openrouter">openrouter</option>
            </select>
            <button class="btn btn-secondary" onclick="clearFilters()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18"></path>
                    <path d="M6 6l12 12"></path>
                </svg>
                Clear
            </button>
            <button class="btn btn-primary" onclick="exportToPDF()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export PDF
            </button>
        </div>

        <div class="cluster-grid">
            
    <div class="cluster-card" data-index="0" data-cluster="cd8-positive, alpha-beta t cell"
         data-maintype="CD8⁺ cytotoxic T lymphocyte (Tc1), intestinal, highly activated / tissue-resident / exhausted" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">cd8-positive, alpha-beta t cell</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">CD8⁺ cytotoxic T lymphocyte (Tc1), intestinal, highly activated / tissue-resident / exhausted</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">CD8⁺ Trm/Tex cytotoxic T cell (intestinal</li><li class="rank-2">XCL1⁺ NK-like)</li><li class="rank-3">NK-receptor–rich NK-like CD8⁺ cytotoxic T cell (intestinal)</li><li class="more">+1 more</li></ul>
        </div>

        

        
        <div class="card-field mixed-types">
            <span class="field-icon">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M8 12h8"></path>
                    <path d="M12 8v8"></path>
                </svg>
            </span>
            <span class="field-label">Mixed Types:</span>
            <span class="field-value">Mixed TCR usage in αβ CD8 T cells with residual TRGC express...</span>
        </div>
        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">KLRC2, XCL2, LINC02446, CRTAM, KLRK1, KLRC4, KLRD1, XCL1, GZMH, CD160, CD8B, NKG...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(0)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="1" data-cluster="intestinal crypt stem cell"
         data-maintype="Intestinal epithelial stem cells (crypt base columnar cells) of the large intestine" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">intestinal crypt stem cell</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Intestinal epithelial stem cells (crypt base columnar cells) of the large intestine</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">LGR5+ crypt base columnar (CBC) stem cells (adult ISC)</li><li class="rank-2">Early transit-amplifying (TA) progenitors with residual ISC signature</li><li class="rank-3">Regenerative/fetal-like ISC-like population (e.g.</li><li class="more">+1 more</li></ul>
        </div>

        

        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">AL031284.1, AC012085.1, IGFBPL1, HMGN2P6, CHCHD2P9, PPIAP40, LGR5, RPL7P54, AC01...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(1)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="2" data-cluster="intestinal enteroendocrine cell"
         data-maintype="Intestinal enteroendocrine cell (neuroendocrine epithelial cell)" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">intestinal enteroendocrine cell</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Intestinal enteroendocrine cell (neuroendocrine epithelial cell)</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">Colonic L cell (GLP‑1/GLP‑2/PYY/INSL5-secreting enteroendocrine cell)</li><li class="rank-2">L/EC hybrid colonic enteroendocrine cell (L-like cell with serotonergic features)</li><li class="rank-3">Generic proglucagon-lineage enteroendocrine cell (GCG⁺PYY⁺ EEC without strict INSL5-based subclassification)</li></ul>
        </div>

        

        
        <div class="card-field mixed-types">
            <span class="field-icon">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M8 12h8"></path>
                    <path d="M12 8v8"></path>
                </svg>
            </span>
            <span class="field-label">Mixed Types:</span>
            <span class="field-value">L/EC hybrid colonic enteroendocrine cell (L-like cell with s...</span>
        </div>
        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">GCG, PCSK1, AC090679.1, UCN3, PYY, INSL5, CHGA, LCN15, SCG2, FEV, CPLX2, NKX2-2,...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(2)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="3" data-cluster="monocyte"
         data-maintype="Neural crest–derived glial cells of the enteric/peripheral nervous system" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">monocyte</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Neural crest–derived glial cells of the enteric/peripheral nervous system</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">Enteric glial cells (ENS glia; SOX10⁺ PLP1⁺ ATP1A2⁺)</li><li class="rank-2">Schwann cells of extrinsic nerve fibers (myelinating/non-myelinating Schwann cells)</li><li class="rank-3">Neural crest–derived glial progenitors / OPC-like peripheral glia</li></ul>
        </div>

        

        
        <div class="card-field mixed-types">
            <span class="field-icon">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M8 12h8"></path>
                    <path d="M12 8v8"></path>
                </svg>
            </span>
            <span class="field-label">Mixed Types:</span>
            <span class="field-value">Enteric glia / Schwann cells, Enteric/peripheral glia (Schwa...</span>
        </div>
        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">NKAIN3, SPP1, CDH19, TSPAN11, PLP1, L1CAM, MYOT, IGSF11, NRXN1, SLC35F1, AL13629...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(3)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="4" data-cluster="plasma cell"
         data-maintype="Plasma cell / antibody-secreting cell (ASC)" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">plasma cell</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Plasma cell / antibody-secreting cell (ASC)</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">Mucosal IgA-secreting plasma cells (CCR10+ IgA+ JCHAIN+ ASCs)</li><li class="rank-2">Class-switched IgG/IgM plasma cells (non-IgA dominant ASCs)</li><li class="rank-3">Activated/inflammatory plasmablast-like plasma cells</li></ul>
        </div>

        

        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">IGLL5, IGLV6-57, JCHAIN, FAM92B, IGLC3, IGLC2, IGHV3-7, IGKC, TNFRSF17, IGHG1, A...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(4)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="5" data-cluster="transit amplifying cell of large intestine"
         data-maintype="Cycling intestinal epithelial cells (crypt progenitor/TA compartment)" data-tissue="large intestine" data-species="human"
         data-model="openai/gpt-5.1" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">transit amplifying cell of large intestine</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">50 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
                
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Cycling intestinal epithelial cells (crypt progenitor/TA compartment)</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li class="rank-1">Cycling transit-amplifying (TA) epithelial cells of the colonic crypt</li><li class="rank-2">Cycling intestinal stem cells (crypt base columnar</li><li class="rank-3">CBC)</li><li class="more">+5 more</li></ul>
        </div>

        

        
        <div class="card-field mixed-types">
            <span class="field-icon">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M8 12h8"></path>
                    <path d="M12 8v8"></path>
                </svg>
            </span>
            <span class="field-label">Mixed Types:</span>
            <span class="field-value">Cycling transit-amplifying (TA) epithelial cells of the colo...</span>
        </div>
        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    openai/gpt-5.1
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">HJURP, UBE2C, CENPA, PBK, AURKB, DLGAP5, CKAP2L, KIF2C, KIF15, BIRC5, SPC25, ASP...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(5)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    
        </div>

        <div id="no-results" class="no-results" style="display: none;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
            </svg>
            <h3>No clusters found</h3>
            <p>Try adjusting your search or filters</p>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-container">
            
    <div class="modal-content" id="modal-content-0">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">cd8-positive, alpha-beta t cell</h2>
                <p class="modal-subtitle">Predicted: <strong>CD8⁺ cytotoxic T lymphocyte (Tc1), intestinal, highly activated / tissue-resident / exhausted</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">KLRC2, XCL2, LINC02446, CRTAM, KLRK1, KLRC4, KLRD1, XCL1, GZMH, CD160, CD8B, NKG7, GZMA, GZMB, GZMK, CD8A, TRGC2, SLA2, TIGIT, TNFRSF9, GPR18, CCL4, PRF1, ATP8B4, APBA2, CCL4L2, DUSP4, CTSW, TMIGD2, TRGC1, CCL5, ABI3, IL21R, IFNG, CD7, CLIC3, ENTPD1, LDLRAD4, PTPN22, HOPX, GZMM, CST7, PARD6G, ZEB2, SH2D1A, LAYN, LAG3, PRKCH, AOAH, IKZF2</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    <ul>
<li>Most probable <strong>general</strong> cell type</li>
</ul>
--------------------------------------<br>
<br>
Putting the functional and lineage markers together:<br>
<br>
- Strong <strong>T-cell lineage</strong>: CD8A, CD8B, CD7, PTPN22, SH2D1A, IL21R<br>
- Strong <strong>cytotoxic effector program</strong>: GZMB/H/K/M, GZMA, PRF1, NKG7, CTSW, CST7<br>
- <strong>NK-receptor rich but T-lineage</strong>: KLRK1, KLRD1, KLRC2, KLRC4, CD160, CRTAM<br>
- <strong>Tc1 cytokine/chemokine program</strong>: IFNG, XCL1/2, CCL4/4L2, CCL5<br>
- <strong>Chronic activation / exhaustion / Trm markers</strong>: ENTPD1, TIGIT, LAG3, LAYN, HOPX, ZEB2, IKZF2<br>
- <strong>Intestinal/IEL-like module</strong>: TRGC1, TRGC2, GPR18, PRKCH<br>
<br>
This profile is most consistent with <strong>T cells</strong>, specifically <strong>CD8⁺ cytotoxic T lymphocytes</strong>, rather than NK cells or other ILCs.<br>
<br>
<strong>General cell type:</strong><br>
<strong>CD8⁺ cytotoxic T lymphocyte (Tc1), intestinal, highly activated / tissue-resident / exhausted.</strong><br>
<br>
---<br>
<br>
<ul>
<li>Top 3 most probable <strong>sub cell types</strong> (ranked)</li>
</ul>
--------------------------------------------------<br>
<br>
<h4>1) Intestinal tissue-resident / exhausted cytotoxic CD8 T cell (most likely)</h4>
<br>
<strong>Rationale:</strong><br>
<br>
- <strong>Tissue-residency / chronic stimulation markers:</strong><br>
- <strong>ENTPD1 (CD39)</strong> – canonical for tissue-resident, chronically stimulated CD8 T in barrier tissues and tumors.<br>
- <strong>LAYN, TIGIT, LAG3</strong> – classical human CD8 Tex/Trm markers (seen in Smillie 2019 colon CD8_Trm/Tex; multiple CRC datasets).<br>
- <strong>HOPX, ZEB2, IKZF2</strong> – Trm/terminal effector TF program.<br>
<br>
- <strong>Effector Tc1 program:</strong><br>
- <strong>GZMB/H/M, PRF1, NKG7, CTSW, CST7</strong>, <strong>XCL1/2</strong>, <strong>IFNG</strong>, <strong>CCL4/5</strong> – canonical for <strong>Trm/Tex CD8 T</strong> in colon (Smillie 2019 “CD8_TRM_LAYN/CD8_Tex”, CRC datasets).<br>
<br>
- <strong>Mucosal localization markers:</strong><br>
- <strong>CRTAM, GPR18</strong> – enriched in mucosal/epithelial CD8 T and IEL-like T cells.<br>
<br>
- <strong>NK-like receptor pattern but clearly T-lineage:</strong><br>
- NK receptors (KLRK1, KLRD1, KLRC2/4, CD160) often appear in <strong>tissue-resident or tumor-infiltrating CD8 T</strong> in mucosa; absence of CD56/FCGR3A supports “NK-like CD8 T” rather than NK.<br>
<br>
This aligns very well with the <strong>CD39⁺, LAYN⁺, TIGIT⁺, LAG3⁺ CD8 Trm/Tex populations</strong> described in human colon and colorectal tumor scRNA-seq atlases.<br>
<br>
<strong>Best short label:</strong><br>
<strong>“CD8⁺ Trm/Tex cytotoxic T cell (intestinal, XCL1⁺ NK-like)”</strong><br>
<br>
<br>
<h4>2) Intestinal NK-like CD8 T cell (non-classical, innate-like cytotoxic CD8)</h4>
<br>
<strong>Rationale:</strong><br>
<br>
- Strong expression of <strong>NK-receptors</strong>:<br>
- KLRK1, KLRD1, KLRC2, KLRC4, CD160 – typical of NK and <strong>NK-like CD8 T</strong>.<br>
- Robust <strong>granule and chemokine program</strong> is compatible with both NK and CD8 T.<br>
- Clear <strong>T-lineage markers (CD8A/B, CD7, TRGC1/2, PTPN22, SH2D1A)</strong> without canonical NK-only markers (NCAM1/CD56, FCGR3A/CD16, KLRF1).<br>
<br>
This matches the “NK-like CD8 T” or “CD8_IEL_NK-like” clusters often found in gut atlases: cytotoxic CD8 T with broad NK-receptor usage, sometimes described as <strong>CD8⁺ ILC1-like</strong>.<br>
<br>
<strong>Short label:</strong><br>
<strong>“NK-receptor–rich NK-like CD8⁺ cytotoxic T cell (intestinal)”</strong><br>
<br>
<h4>3) Intestinal γδ-like cytotoxic T / IEL-like T cell</h4>
<br>
<strong>Rationale:</strong><br>
<br>
- <strong>γδ/IEL-associated markers:</strong><br>
- <strong>TRGC1, TRGC2</strong> – strong hallmarks of TCRγ usage.<br>
- <strong>GPR18, PRKCH</strong> – enriched in γδ T and IEL programs.<br>
- Intestinal context favors <strong>IEL-like T</strong> populations, which include both αβ and γδ T cells with a highly cytotoxic program.<br>
<br>
However:<br>
<br>
- <strong>CD8B is strongly expressed</strong>, which is more typical of CD8αβ αβ T cells, whereas classical human γδ IELs are often CD8αα or CD8⁻.<br>
- The gene list does not include clear TRDC/TRDV/TRGV reads (though they may exist outside this ranked list).<br>
<br>
Therefore, γδ/IEL-like identity is <strong>plausible but less strongly supported</strong> than Trm/Tex CD8 identity. It is likely that some cells in this cluster are γδ or share a <strong>γδ-enriched/IEL program</strong>, but the dominant annotation remains αβ CD8 Trm/Tex.<br>
<br>
<strong>Short label:</strong><br>
<strong>“Intestinal IEL-like T cell with γδ-associated transcriptional features”</strong><br>
<br>
---<br>
<br>
<ul>
<li>Concise summary and final annotation</li>
</ul>
---------------------------------------<br>
<br>
- The cluster is <strong>T-lineage, not NK</strong>, based on CD8A/B, CD7, TRGC1/2, PTPN22, SH2D1A, IL21R and lack of classical NK-only markers.<br>
- It shows a <strong>strong cytotoxic Tc1 profile</strong> (GZMB/H/M, PRF1, NKG7, CTSW, CCL4/5, XCL1/2, IFNG).<br>
- Co-expression of <strong>ENTPD1 (CD39), LAYN, TIGIT, LAG3, HOPX, ZEB2, IKZF2</strong> indicates <strong>tissue-resident / exhausted CD8 T cells</strong> in a chronically stimulated environment (mucosa/tumor).<br>
- NK receptors (KLRK1, KLRD1, KLRC2/4, CD160, CRTAM) indicate an <strong>NK-like effector phenotype</strong>, common in mucosal Trm/Tex CD8 subsets.<br>
- Intestinal / IEL-like markers (TRGC1/2, GPR18, PRKCH) support localization to <strong>intestinal epithelium or lamina propria</strong> with an IEL-like program.<br>
<br>
<strong>Final ranked annotation:</strong><br>
<br>
<ul>
<li><strong>Most likely:</strong>  </li>
</ul>
<strong>Intestinal CD8⁺ tissue-resident / exhausted cytotoxic T cell (Trm/Tex, XCL1⁺, CD39⁺, NK-receptor–rich)</strong><br>
<br>
<ul>
<li><strong>Second:</strong>  </li>
</ul>
<strong>Intestinal NK-like CD8⁺ cytotoxic T cell (innate-like CD8, KLRK1⁺KLRD1⁺)</strong><br>
<br>
<ul>
<li><strong>Third:</strong>  </li>
</ul>
<strong>Intestinal IEL-like T cell with γδ-associated features (TRGC1/2⁺, GPR18⁺)</strong><br>
<br>
<strong>Preferred final label for this cluster:</strong><br>
<strong>CD8⁺ Trm/Tex cytotoxic T cell (intestinal, NK-like / XCL1⁺)</strong><br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">CD8⁺ cytotoxic T lymphocyte (Tc1), intestinal, highly activated / tissue-resident / exhausted</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">CD8⁺ Trm/Tex cytotoxic T cell (intestinal, XCL1⁺ NK-like)</li><li class="rank-2">NK-receptor–rich NK-like CD8⁺ cytotoxic T cell (intestinal)</li><li class="rank-3">Intestinal IEL-like T cell with γδ-associated transcriptional features</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li>Mixed TCR usage in αβ CD8 T cells with residual TRGC expression</li><li>γδ T–enriched intestinal IEL-like CD8 T-cell subset that expresses CD8B</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-1">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">intestinal crypt stem cell</h2>
                <p class="modal-subtitle">Predicted: <strong>Intestinal epithelial stem cells (crypt base columnar cells) of the large intestine</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">AL031284.1, AC012085.1, IGFBPL1, HMGN2P6, CHCHD2P9, PPIAP40, LGR5, RPL7P54, AC010132.3, EIF5AP4, AC008694.2, COX5AP2, TDGF1, ASCL2, AC092670.1, NPM1P6, PPIAP11, AC090498.1, RPL41P1, CYCSP55, HMGN2P4, TPI1P1, RPL41P5, AL162151.2, PPIAP29, HNRNPA1P4, AC016596.2, AL603825.1, RPL9P21, AC005884.2, PPIAP31, HMGN1P36, HMGN2P41, AL035411.1, RPS26P39, FABP5P7, SDHDP6, ATP5PFP1, EEF1A1P5, RPSAP8, HMGN2P3, SLC39A2, KRT8P13, RPL21P16, RPSAP15, HMGN1P38, AF279873.1, RPL7P6, AC112491.1, AC022968.1</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    <ul>
<li>Key functional / pathway markers in the list and their roles</li>
</ul>
---------------------------------------------------------------<br>
<br>
Focusing on the <em>coding</em> / non-pseudogene entries that are biologically informative:<br>
<br>
- <strong>LGR5 (Leucine-rich repeat-containing G-protein coupled receptor 5)</strong><br>
- Canonical Wnt target gene and receptor for R-spondins.<br>
- Master marker of <strong>intestinal stem cells (ISCs)</strong> in crypt base columnar (CBC) cells.<br>
- Highly enriched at the crypt base of small intestine and colon; defines long-term, self-renewing stem cells.<br>
<br>
- <strong>ASCL2 (Achaete-Scute Family BHLH Transcription Factor 2)</strong><br>
- Wnt-responsive transcription factor; crucial for maintenance of <strong>LGR5+ intestinal stem cells</strong>.<br>
- Directly regulates a stem cell gene program; loss leads to depletion of CBC stem cells.<br>
- Strongly co-expressed with LGR5 in ISC population.<br>
<br>
- <strong>TDGF1 (Teratocarcinoma-Derived Growth Factor 1 / Cripto)</strong><br>
- GPI-anchored EGF-CFC family protein; co-receptor for NODAL and related TGF-β ligands.<br>
- Enriched in <strong>embryonic / fetal-like or stem/progenitor</strong> states in multiple epithelia.<br>
- In gut, associated with high Wnt and progenitor/ISC-like programs; often upregulated in regenerative or more primitive epithelial states.<br>
<br>
- <strong>IGFBPL1 (Insulin Like Growth Factor Binding Protein Like 1)</strong><br>
- IGFBP-like protein modulating IGF signaling and growth/survival.<br>
- Not gut-specific, but expression is often enriched in progenitor / stem-like contexts in various tissues.<br>
<br>
- <strong>SLC39A2 (ZIP2, Solute Carrier Family 39 Member 2)</strong><br>
- Zinc importer; zinc is important for proliferating cells and for transcription factor function.<br>
- Typically higher in metabolically active, proliferative, or stem/progenitor compartments rather than terminally differentiated colonocytes.<br>
<br>
The remainder of the list is dominated by:<br>
<br>
- <strong>Histone and chromatin-associated pseudogenes</strong>:<br>
- HMGN2P6, HMGN2P9, HMGN2P4, HMGN2P41, HMGN2P3, HMGN1P36, HMGN1P38<br>
- <strong>Ribosomal and translation-related pseudogenes</strong>:<br>
- RPL7P54, RPL41P1, RPL41P5, RPL9P21, RPL21P16, RPL7P6, RPS26P39, RPSAP8, RPSAP15<br>
- <strong>PPIA and metabolic enzyme pseudogenes</strong>:<br>
- PPIAP40, PPIAP11, PPIAP29, PPIAP31, TPI1P1, COX5AP2, SDHDP6, ATP5PFP1, EIF5AP4, EEF1A1P5<br>
- <strong>Other non-coding / lncRNA-like / uncharacterized loci</strong>:<br>
- AL031284.1, AC012085.1, AC010132.3, AC008694.2, AC092670.1, AC090498.1, AL162151.2, AC016596.2, AL603825.1, AC005884.2, AL035411.1, AF279873.1, AC112491.1, AC022968.1, FABP5P7, KRT8P13, etc.<br>
<br>
These mostly reflect high global transcriptional/translation activity and technical mapping to pseudogenes, and do not strongly constrain cell identity beyond indicating a metabolically active/proliferative state.<br>
<br>
Functionally, the <strong>Wnt-driven stemness program</strong> (LGR5, ASCL2, TDGF1) is the dominant informative signal in this marker set.<br>
<br>
<br>
<br>
<ul>
<li>Key cell-type markers and their implications</li>
</ul>
-----------------------------------------------<br>
<br>
<h4>Intestinal epithelial stem/progenitor markers</h4>
<br>
- <strong>LGR5</strong><br>
- Gold-standard marker of <strong>intestinal crypt base columnar (CBC) stem cells</strong> in both small intestine and colon.<br>
- Specifically marks long-lived stem cells at crypt base, not Paneth, goblet, enteroendocrine, or mature colonocytes.<br>
<br>
- <strong>ASCL2</strong><br>
- ISC-specific transcription factor, essential for maintenance of the LGR5+ pool.<br>
- Highly enriched in CBCs in human and mouse colon; co-localizes with LGR5.<br>
<br>
- <strong>TDGF1</strong><br>
- Not a classic “textbook” ISC marker, but in intestinal and colonic epithelium it is:<br>
- Upregulated in stem/progenitor / fetal-like programs.<br>
- Enriched in high-Wnt/high-plasticity contexts (development, regeneration, and sometimes cancer stem-like compartments).<br>
- Its presence alongside LGR5/ASCL2 supports a <strong>primitive stem/progenitor identity</strong> rather than a differentiated lineage.<br>
<br>
- <strong>Absence of canonical lineage markers</strong><br>
- No markers for:<br>
- Goblet cells: e.g., MUC2, TFF3.<br>
- Enteroendocrine cells: e.g., CHGA, CHGB, NEUROD1, PAX6.<br>
- Tuft cells: e.g., DCLK1, TRPM5, POU2F3.<br>
- Colonocytes / absorptive enterocytes: e.g., KRT20, CA1/2, ALPI, SLC26A3, EPCAM-high with KRT20, etc.<br>
- Paneth-like/secretory (more prominent in small intestine but some colonic crypt base secretory): LYZ, defensins.<br>
- Strong lack of differentiated-lineage markers suggests a <strong>stem or very early progenitor</strong> cluster.<br>
<br>
<h4>General epithelial context</h4>
<br>
- Presence of (pseudo)keratin KRT8P13, FABP5P7 (FABP5-like), many ribosomal/translation genes:<br>
- Compatible with an <strong>epithelial</strong>, metabolically active cell population.<br>
- But these are not specific enough to distinguish epithelial subtypes; the specificity comes from LGR5/ASCL2.<br>
<br>
Collectively, the strongest identity-defining markers in this list are <strong>LGR5 and ASCL2</strong>, which are <em>definitive</em> for <strong>intestinal epithelial stem cells</strong> in crypts of the large intestine.<br>
<br>
<br>
<br>
<ul>
<li>Cross-referencing with scRNA-seq databases and literature</li>
</ul>
------------------------------------------------------------<br>
<br>
Using knowledge from common resources and literature (rather than live queries):<br>
<br>
- <strong>PanglaoDB / CellMarker / Human Cell Atlas (HCA) / Tabula Sapiens / gut atlases (e.g., Martin et al., Smillie et al., Elmentaite et al.)</strong><br>
- Intestinal stem cell clusters from human colon consistently show:<br>
- <strong>LGR5</strong>, <strong>ASCL2</strong>, <strong>SMOC2</strong>, <strong>MEX3A</strong>, <strong>OLFM4</strong>, <strong>SOX9</strong>, high Wnt target gene expression.<br>
- LGR5 and ASCL2 are heavily used to annotate <strong>“intestinal stem cell / crypt base columnar (CBC) cells”</strong>.<br>
- TDGF1 expression has been reported in:<br>
- Fetal intestinal epithelial progenitors.<br>
- Regenerative/fetal-like stem-like populations in IBD and injury.<br>
- High-Wnt stem/progenitor states, including some colon cancer stem-like cells.<br>
<br>
- <strong>Literature</strong><br>
- Barker et al., Nature 2007; Barker, van Es et al. – define <strong>LGR5+ CBC cells as the intestinal stem cell</strong> population.<br>
- van der Flier et al., <em>Cell</em> 2009; Schuijers et al. – describe <strong>ASCL2</strong> as a Wnt-driven TF essential for intestinal stem cell maintenance and co-expressed with LGR5 in CBCs.<br>
- Recent human colonic scRNA-seq atlases (Smillie et al., <em>Cell</em> 2019; Elmentaite et al., Nature 2021) identify <strong>LGR5+/ASCL2+ clusters</strong> as “crypt base columnar / intestinal stem cells”.<br>
<br>
These datasets and papers uniformly support the interpretation that a cluster marked strongly by <strong>LGR5 and ASCL2</strong>, in large intestine epithelium, corresponds to <strong>intestinal stem cells at the crypt base</strong> rather than transit-amplifying or differentiated cells.<br>
<br>
<br>
<br>
<ul>
<li>Most probable general cell type</li>
</ul>
----------------------------------<br>
<br>
Based on:<br>
<br>
- Strong expression of <strong>LGR5</strong> and <strong>ASCL2</strong> (canonical Wnt-high ISC markers).<br>
- Presence of <strong>TDGF1</strong> supporting a primitive, stem/progenitor program.<br>
- Absence of canonical differentiated epithelial lineage markers.<br>
- Context specified as <strong>human large intestine (colonic) tissue</strong>.<br>
<br>
<strong>Most probable general cell type:</strong><br>
<br>
&gt; <strong>Intestinal epithelial stem cells (crypt base columnar cells) of the large intestine.</strong><br>
<br>
<br>
<br>
<ul>
<li>Top 3 most probable sub cell types (ranked) and final subtype call</li>
</ul>
---------------------------------------------------------------------<br>
<br>
Within the broad category of <strong>intestinal epithelial stem/progenitor compartment</strong>, plausible subtypes include:<br>
<br>
<ul>
<li><strong>LGR5+ crypt base columnar (CBC) stem cells (adult ISC) – Most likely</strong></li>
</ul>
- Defining features:<br>
- High <strong>LGR5</strong> and <strong>ASCL2</strong> co-expression.<br>
- Wnt target gene program characteristic of crypt base.<br>
- The marker set provided exactly matches this signature:<br>
- No evidence of early differentiation toward any secretory or absorptive lineage.<br>
- No strong alternative lineage-defining markers present.<br>
- This is the canonical “intestinal stem cell” population in human colon.<br>
<br>
<ul>
<li><strong>Early transit-amplifying (TA) progenitors with residual ISC signature – Second most likely</strong></li>
</ul>
- TA cells just above the crypt base often:<br>
- Show reduced but still detectable <strong>LGR5</strong> / <strong>ASCL2</strong> expression.<br>
- Are highly proliferative and transcriptionally active (fits the pseudogene/ribosomal-rich pattern).<br>
- Counterpoint:<br>
- In many datasets, strong LGR5/ASCL2 is more tightly restricted to CBCs, with TA cells showing lower, more diffuse Wnt target expression and acquisition of early differentiation markers (which are not seen here).<br>
- So this is plausible but less well supported than pure CBC stem cells.<br>
<br>
<ul>
<li><strong>Regenerative/fetal-like ISC-like population (e.g., TDGF1-high stem/progenitor) – Third most likely</strong></li>
</ul>
- TDGF1 is associated with:<br>
- Fetal intestinal epithelium.<br>
- Regeneration/injury and “fetal-like” stem states.<br>
- In some colonic scRNA-seq studies, there are <strong>revival/fetal-like stem cell clusters</strong> distinct from canonical LGR5+ CBCs (often also expressing TACSTD2, LY6-family markers, etc.).<br>
- In this list:<br>
- TDGF1 supports a primitive state, but we <strong>lack other canonical fetal-like markers</strong>.<br>
- Thus a regenerative/fetal-like ISC subtype is conceivable but <strong>less likely</strong> than canonical CBC stem cells.<br>
<br>
<h4>Final subtype annotation</h4>
<br>
Given the dominance and specificity of LGR5 and ASCL2 and the absence of alternative lineage signatures, the most parsimonious and well-supported annotation is:<br>
<br>
&gt; <strong>Most likely subtype: LGR5⁺/ASCL2⁺ crypt base columnar intestinal stem cells (adult colonic ISCs).</strong><br>
<br>
<br>
<br>
<ul>
<li>Concise summary</li>
</ul>
------------------<br>
<br>
- The only clearly informative, non-pseudogene markers are <strong>LGR5</strong>, <strong>ASCL2</strong>, and <strong>TDGF1</strong>, supported by a background of high ribosomal/translation-related pseudogenes indicating a highly active, proliferative state.<br>
- <strong>LGR5</strong> and <strong>ASCL2</strong> are canonical markers of <strong>intestinal crypt base columnar stem cells</strong> in the colon; databases and atlases consistently label LGR5+/ASCL2+ clusters as ISCs.<br>
- Lack of any goblet, enteroendocrine, tuft, Paneth-like, or mature colonocyte markers further supports a stem rather than differentiated identity.<br>
- TDGF1 is consistent with a primitive Wnt-high stem/progenitor signature, potentially with some fetal-like or regenerative bias, but not sufficient to override the canonical CBC assignment.<br>
<br>
<strong>Final annotation:</strong><br>
<br>
- <strong>General cell type:</strong> Intestinal epithelial stem cell.<br>
- <strong>Specific subtype:</strong> <strong>LGR5⁺/ASCL2⁺ crypt base columnar (CBC) stem cell of the human large intestine.</strong><br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Intestinal epithelial stem cells (crypt base columnar cells) of the large intestine</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">LGR5+ crypt base columnar (CBC) stem cells (adult ISC)</li><li class="rank-2">Early transit-amplifying (TA) progenitors with residual ISC signature</li><li class="rank-3">Regenerative/fetal-like ISC-like population (e.g., TDGF1-high stem/progenitor)</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li class="empty">None identified</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-2">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">intestinal enteroendocrine cell</h2>
                <p class="modal-subtitle">Predicted: <strong>Intestinal enteroendocrine cell (neuroendocrine epithelial cell)</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">GCG, PCSK1, AC090679.1, UCN3, PYY, INSL5, CHGA, LCN15, SCG2, FEV, CPLX2, NKX2-2, AL133325.3, C1orf127, LINC01014, SCGN, SLC18A1, SCG3, SCG5, TPH1, MARCH4, INSM1, RTN1, CRYBA2, SNAP25, CHGB, CRMP1, KCNB2, RFX6, AMER3, SLC32A1, CDK5R2, AVPR1B, VWA5B2, AC022893.2, ABCC8, RIMBP2, AL161658.1, COL2A1, CELF3, SCT, RIIAD1, SSTR5-AS1, RGS4, ARX, PRPH, INA, F5, AP003062.3, SLC5A8</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    <ul>
<li><strong>Top 3 Most Probable Subtypes (within enteroendocrine cells)</strong>  </li>
</ul>
<br>
You already have:<br>
<br>
- <strong>Rank 1 – Colonic L cell (GLP‑1/GLP‑2/PYY/INSL5-secreting enteroendocrine cell)</strong><br>
- <strong>Rank 2 – L/EC hybrid colonic enteroendocrine cell (L-like cell with serotonergic features)</strong><br>
<br>
I’ll add a third plausible but less likely subtype and then state the final choice.<br>
<br>
---<br>
<br>
<strong>Rank 3 – Generic proglucagon-lineage enteroendocrine cell (GCG⁺PYY⁺ EEC without strict INSL5-based subclassification)</strong><br>
<br>
Rationale:<br>
<br>
- A subset of human intestinal EECs in scRNA-seq atlases can be broadly defined as <strong>GCG⁺PYY⁺ proglucagon-lineage cells</strong>, sometimes annotated simply as <strong>“GCG⁺ EEC”</strong> or <strong>“proglucagon EEC”</strong>, without explicit subdivision into L vs hybrid states.<br>
- The presence of:<br>
- <strong>GCG + PYY</strong> (canonical L/proglucagon-lineage hormones),<br>
- strong <strong>neuroendocrine machinery</strong> (CHGA/B, SCG2/3/5, SNAP25, SLC18A1, SLC32A1, CPLX2, RIMBP2),<br>
- and <strong>EEC TFs</strong> (RFX6, NKX2-2, INSM1, ARX, FEV),<br>
unequivocally places these cells in the <strong>proglucagon⁺ enteroendocrine lineage</strong>, even if one chose not to resolve finer L vs L/EC subtypes.<br>
- This would be the label you might use if:<br>
- clustering resolution is low, or<br>
- you prefer <strong>collapsing L and L/EC into a single “GCG⁺PYY⁺ EEC” class</strong> to maintain cross-dataset comparability.<br>
<br>
It is less specific than calling them “L cells” and does not exploit the strong INSL5 signal, hence ranked third.<br>
<br>
---<br>
<br>
<strong>Most likely subtype (final choice)</strong><br>
<br>
Given the <strong>very strong, hallmark combination</strong>:<br>
<br>
- <strong>GCG + PYY + INSL5</strong><br>
- Classic <strong>neuroendocrine/EEC TFs</strong>: RFX6, INSM1, NKX2-2, ARX, FEV<br>
- Neuroendocrine secretion machinery: CHGA/B, SCG2/3/5, SLC18A1, SNAP25, CPLX2, RIMBP2<br>
- Colonic context (large intestine)<br>
<br>
the <strong>most specific and well-supported annotation</strong> is:<br>
<br>
&gt; <strong>Colonic L cell (GCG⁺/PYY⁺/INSL5⁺ enteroendocrine cell)</strong><br>
<br>
You can optionally note in your metadata that this cluster exhibits <strong>some serotonergic machinery (TPH1)</strong> consistent with <strong>L/EC-like features</strong>, but functionally and transcriptionally it is best classified as a <strong>distal colonic L cell</strong>.<br>
<br>
---<br>
<br>
<ul>
<li><strong>Concise Summary of Analysis</strong></li>
</ul>
<br>
- The marker set is dominated by:<br>
- <strong>Enteroendocrine hormones</strong>: GCG, PYY, INSL5, UCN3, SCT<br>
- <strong>Neuroendocrine granule and vesicle genes</strong>: CHGA/B, SCG2/3/5, SNAP25, CPLX2, SLC18A1, SLC32A1, RIMBP2<br>
- <strong>EEC lineage TFs</strong>: RFX6, NKX2-2, INSM1, FEV, ARX<br>
- <strong>Serotonin enzyme</strong>: TPH1<br>
- This unambiguously defines a <strong>neuroendocrine enteroendocrine epithelial cell</strong> from the gut.<br>
- The specific combination <strong>GCG + PYY + INSL5</strong> in <strong>colon</strong> is the signature of <strong>distal colonic L cells</strong>, as shown in multiple human gut scRNA-seq atlases (e.g., Elmentaite et al., Smillie et al.).<br>
- TPH1 expression suggests a degree of <strong>L/EC hybridization</strong>, but does not override the L-cell-defining hormone pattern.<br>
<br>
*<em>Final annotation for this cluster:<br>
→ “Enteroendocrine L cells (colonic GCG⁺/PYY⁺/INSL5⁺ L cells; L/EC-hybrid-like)”</em>*<br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Intestinal enteroendocrine cell (neuroendocrine epithelial cell)</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">Colonic L cell (GLP‑1/GLP‑2/PYY/INSL5-secreting enteroendocrine cell)</li><li class="rank-2">L/EC hybrid colonic enteroendocrine cell (L-like cell with serotonergic features)</li><li class="rank-3">Generic proglucagon-lineage enteroendocrine cell (GCG⁺PYY⁺ EEC without strict INSL5-based subclassification)</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li>L/EC hybrid colonic enteroendocrine cell (L-like cell with serotonergic features)</li><li>Enteroendocrine L cells (colonic GCG⁺/PYY⁺/INSL5⁺ L cells; L/EC-hybrid-like)</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-3">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">monocyte</h2>
                <p class="modal-subtitle">Predicted: <strong>Neural crest–derived glial cells of the enteric/peripheral nervous system</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">NKAIN3, SPP1, CDH19, TSPAN11, PLP1, L1CAM, MYOT, IGSF11, NRXN1, SLC35F1, AL136298.1, SFRP5, Z97205.2, AL358216.1, SOX10, MEGF10, SYT10, CADM2, SLITRK2, SOX2, CRTAC1, CHL1, ZNF536, FOXD3, PTPRZ1, GRIK3, TUBB2B, CMTM5, LINC01436, TTYH1, ADARB2, CDH2, TENM3, WNT6, ATP1A2, NRXN3, KCNMB4, TMEM132B, LPL, GFRA2, CHADL, FLRT1, CHST9, GJC3, Z95114.1, RHAG, FOXD3-AS1, BMS1P10, FAM19A5, FGFBP2</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    …continuing from your step 5:<br>
<br>
---<br>
<br>
<ul>
<li>Top 3 most probable sub–cell types (ranked)  </li>
</ul>
<br>
<strong>General class (agreed): neural crest–derived peripheral/enteric glia</strong><br>
<br>
Within this class, the marker combination and tissue context argue for the following hierarchy:<br>
<br>
---<br>
<br>
<h4>1) Enteric glial cells (ENS glia; SOX10⁺ PLP1⁺ ATP1A2⁺) – <strong>Most likely</strong></h4>
<br>
<strong>Why this fits best in large intestine:</strong><br>
<br>
- <strong>Canonical ENS glial TF/core markers:</strong><br>
- <strong>SOX10</strong> – obligatory neural crest glial TF; robustly marks enteric glia in gut atlases.<br>
- <strong>ATP1A2</strong> – glial Na⁺/K⁺-ATPase isoform; strongly expressed in ENS glia, helps buffer extracellular K⁺ and neurotransmitter-induced ion fluxes.<br>
- <strong>PLP1, CMTM5, CDH19</strong> – expressed by <strong>PLP1⁺ enteric glia/peripheral glia</strong> in human colon datasets (Azimuth/HCA, Tabula Sapiens) often annotated collectively as “enteric/peripheral glia”.<br>
<br>
- <strong>Neuron-contact / plexus-associated phenotype:</strong><br>
- <strong>NRXN1/3, L1CAM, CHL1, CADM2, CRTAC1, SLITRK2, FLRT1, GJC3, GFRA2</strong> – a strong adhesion/neuron–glia interaction program characteristic of cells physically embedded in myenteric/submucosal plexuses and nerve bundles.<br>
- This is exactly the profile seen in <strong>myenteric and submucosal enteric glia</strong>, which ensheath neuronal cell bodies and fibers rather than existing as free stromal cells.<br>
<br>
- <strong>Neural crest/progenitor flavor within ENS glia:</strong><br>
- <strong>SOX2, FOXD3, ZNF536, FOXD3-AS1</strong> – neural crest / neural progenitor TFs often retained in subsets of <strong>ENS glia</strong> that are more plastic, particularly in human datasets where developmental programs remain partially active.<br>
<br>
- <strong>Gut context constraint:</strong><br>
- In large intestine preparations, these SOX10⁺PLP1⁺ clusters are routinely annotated as <strong>“enteric glial cells” or “peripheral glia (enteric/Schwann-like)”</strong>, rather than pure Schwann cells or CNS oligodendrocytes, because oligodendrocytes are absent and isolated Schwann-only bundles are relatively underrepresented compared to ENS plexuses.<br>
<br>
<strong>Interpretation:</strong><br>
The most parsimonious and reference-consistent label is <strong>Enteric glial cells (ENS glia, Schwann-like)</strong>, likely enriched for plexus-associated glia (myenteric/submucosal) rather than mucosal fibroblast-like glia.<br>
<br>
---<br>
<br>
<h4>2) Schwann cells of extrinsic nerve fibers (myelinating/non-myelinating Schwann cells) – <strong>Second most likely</strong></h4>
<br>
There is a non-trivial argument that this cluster could instead (or additionally) represent Schwann cells on extrinsic autonomic or sensory fibers coursing through the gut wall:<br>
<br>
- <strong>Strong Schwann/myelinating-glia signatures:</strong><br>
- <strong>CDH19</strong> – very characteristic of <strong>peripheral myelinating Schwann cells</strong> in peripheral nerve and DRG scRNA-seq.<br>
- <strong>PLP1, CMTM5</strong> – robust in <strong>myelinating glia</strong> (CNS oligodendrocytes and PNS Schwann cells).<br>
- <strong>L1CAM, CHL1, NRXN1/3, CADM2</strong> – highly expressed in peripheral nerve tracts and Schwann–axon complexes.<br>
<br>
- <strong>Neural crest TFs supporting Schwann identity:</strong><br>
- <strong>SOX10, FOXD3, SOX2</strong> – canonical for Schwann cell lineage and its progenitors, in addition to enteric glia.<br>
<br>
- <strong>Why this is ranked second, not first:</strong><br>
- In colon scRNA-seq, Schwann cells of extrinsic nerves and ENS glia often <strong>co-cluster and share a very similar marker set</strong>.<br>
- When annotation is forced, datasets frequently label these as “peripheral glia / enteric glia / Schwann cells” as a combined compartment.<br>
- Given bulk tissue sampling from <strong>large intestine</strong>, ENS glia numerically dominate over isolated extrinsic Schwann cells, so a pure “Schwann cell only” interpretation is less likely than a mixed or ENS-dominated peripheral glia population.<br>
<br>
<strong>Interpretation:</strong><br>
The cluster may include or closely resemble <strong>Schwann cells of extrinsic innervation</strong>, but in the colonic context this is typically merged into the broader <strong>enteric/peripheral glia</strong> annotation.<br>
<br>
---<br>
<br>
<h4>3) Neural crest–derived glial progenitors / OPC-like peripheral glia – <strong>Third most likely</strong></h4>
<br>
A third possibility is that this cluster corresponds to a <strong>more progenitor-like glial state</strong> within the ENS/peripheral glia compartment:<br>
<br>
- Supporting features:<br>
- <strong>SOX2, FOXD3, ZNF536, PTPRZ1</strong> – associated with <strong>neural progenitors / OPC-like states</strong> in CNS and with more plastic neural crest glial precursors in PNS.<br>
- <strong>TUBB2B, MEGF10, TMEM132B, TTYH1</strong> – enriched in developing neural/glial populations and remodeling glia.<br>
- Expression of <strong>SPP1</strong> and <strong>LPL</strong> hints at an <strong>activated or remodeling phenotype</strong>, possibly involved in injury/repair or structural plasticity of the ENS.<br>
<br>
- Arguments against this as the primary interpretation:<br>
- Clear expression of mature/peripheral glial structural and adhesion genes (NRXN1/3, CADM2, L1CAM, PLP1, CMTM5) suggests a <strong>functionally differentiated glial cell</strong> maintaining axon–glia interfaces, not a purely cycling or migratory progenitor pool.<br>
- No obvious proliferative signature markers (e.g. <strong>MKI67, TOP2A</strong>) among the top markers.<br>
<br>
<strong>Interpretation:</strong><br>
More plausibly, this cluster represents <strong>mature peripheral/enteric glia with a retained progenitor-like transcriptional program</strong>, rather than a dedicated progenitor-only compartment.<br>
<br>
---<br>
<br>
<h4>Most likely subtype annotation</h4>
<br>
Considering:<br>
<br>
- Tissue: <strong>human large intestine</strong><br>
- Marker set: <strong>SOX10⁺, PLP1⁺, CDH19⁺, CMTM5⁺, ATP1A2⁺, PTPRZ1⁺, NRXN1/3⁺, L1CAM⁺, CHL1⁺, CADM2⁺, GFRA2⁺, SFRP5/WNT6⁺, MEGF10⁺</strong><br>
- Absence of epithelial, stromal, immune, or endothelial signatures<br>
<br>
The most appropriate, atlas-consistent annotation is:<br>
<br>
&gt; <strong>Enteric glial cell / peripheral glia (Schwann-like ENS glia)</strong><br>
<br>
If you need a single label for downstream analysis, I would use:<br>
<br>
&gt; <strong>“Enteric glia (SOX10⁺ PLP1⁺)”</strong><br>
<br>
to align with most colon scRNA-seq references, while noting in metadata that these are <strong>Schwann-like peripheral glia associated with ENS and extrinsic nerve fibers</strong>.<br>
<br>
---<br>
<br>
<ul>
<li>Concise summary of analysis</li>
</ul>
<br>
- The cluster is dominated by <strong>neural crest–derived glial markers</strong> (SOX10, SOX2, FOXD3, PLP1, CMTM5, CDH19, ATP1A2, PTPRZ1, MEGF10, GJC3, LPL) with <strong>strong neuron-contact adhesion and synaptic-associated genes</strong> (NRXN1/3, L1CAM, CHL1, CADM2, CRTAC1, FLRT1, SLITRK2, GFRA2, TUBB2B).<br>
- No intestinal epithelial, fibroblast, smooth muscle, endothelial, or canonical immune programs are present, excluding those lineages.<br>
- Cross-referencing gut and brain scRNA-seq atlases indicates this pattern is highly characteristic of <strong>enteric/peripheral glia in the colon</strong>, often annotated as <strong>enteric glia / Schwann cells</strong>.<br>
- Among possible subtypes, <strong>enteric glial cells (ENS glia, Schwann-like) &gt; extrinsic Schwann cells &gt; glial progenitor-like cells</strong> is the most reasonable ranking.<br>
<br>
<strong>Final cell-type annotation for this cluster:</strong><br>
<strong>Enteric glial cells (SOX10⁺ PLP1⁺ peripheral/Schwann-like glia of the ENS).</strong><br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Neural crest–derived glial cells of the enteric/peripheral nervous system</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">Enteric glial cells (ENS glia; SOX10⁺ PLP1⁺ ATP1A2⁺)</li><li class="rank-2">Schwann cells of extrinsic nerve fibers (myelinating/non-myelinating Schwann cells)</li><li class="rank-3">Neural crest–derived glial progenitors / OPC-like peripheral glia</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li>Enteric glia / Schwann cells</li><li>Enteric/peripheral glia (Schwann-like ENS glia)</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-4">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">plasma cell</h2>
                <p class="modal-subtitle">Predicted: <strong>Plasma cell / antibody-secreting cell (ASC)</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">IGLL5, IGLV6-57, JCHAIN, FAM92B, IGLC3, IGLC2, IGHV3-7, IGKC, TNFRSF17, IGHG1, AC026369.3, IGHV3-23, IGKV4-1, IGKV1-5, IGHA1, IGLV3-1, IGLV2-11, MYL2, MZB1, IGHG3, IGHV3-74, IGHM, ANKRD36BP2, AMPD1, IGKV3-20, IGHA2, DERL3, AC104699.1, LINC02362, AL391056.1, LILRB4, CCL3, BMP6, UBE2QL1, LINC00309, AL133467.1, GPRC5D, FCRL5, DNAAF1, AP002852.1, AC007569.1, CXorf21, RNU1-85P, U62317.4, TXNDC5, LINC02384, CCR10, BFSP2, APOBEC3A, AC106897.1</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    <ul>
<li>Key functional markers and their roles  </li>
</ul>
- Immunoglobulin genes (hallmark of antibody-secreting cells)<br>
- Heavy chain: <strong>IGHG1, IGHG3, IGHM, IGHA1, IGHA2, IGHV3-7, IGHV3-23, IGHV3-74</strong><br>
- High-level expression of multiple constant regions (γ, μ, α) and diverse V segments indicates cells fully engaged in high-rate antibody production, not naive/memory B cells.<br>
- Light chain κ/λ: <strong>IGKC, IGKV4-1, IGKV1-5, IGKV3-20, IGLL5, IGLC2, IGLC3, IGLV6-57, IGLV3-1, IGLV2-11</strong><br>
- Intense expression of both κ and λ light chains (plus IGLL5) is typical of mature plasma cells where Ig transcription dominates the transcriptome.<br>
<br>
- Secretory apparatus / unfolded protein response<br>
- <strong>MZB1</strong> – ER-resident co-chaperone that facilitates Ig heavy chain assembly; strongly enriched in plasmablasts/plasma cells.<br>
- <strong>DERL3</strong> – ER-associated degradation component, supports high secretory load.<br>
- <strong>TXNDC5</strong> – ER protein disulfide isomerase-like, involved in oxidative folding of secreted proteins.<br>
- Collectively these point to a cell highly specialized for secretion with expanded ER.<br>
<br>
- Polymeric Ig formation and mucosal immunity<br>
- <strong>JCHAIN (J chain)</strong> – required for polymerization of IgA and IgM and for binding to the polymeric Ig receptor (pIgR) for transcytosis across epithelium. Highly characteristic of mucosal plasma cells secreting dimeric IgA and pentameric IgM.<br>
<br>
- TNF-family signaling / plasma cell survival<br>
- <strong>TNFRSF17 (BCMA)</strong> – canonical receptor on plasma cells mediating survival signals from BAFF/APRIL; a gold-standard marker for antibody-secreting cells.<br>
<br>
- Chemokines / chemokine receptors<br>
- <strong>CCR10</strong> – chemokine receptor for CCL27/CCL28; critical for homing of IgA-secreting cells to mucosal sites (including colon). Strongly associated with mucosal IgA plasma cells.<br>
- <strong>CCL3</strong> – inflammatory chemokine (MIP-1α), often up in activated B/plasma cells and can be a feature of plasmablast-like or inflammatory ASCs.<br>
<br>
- Other immune/function-associated genes<br>
- <strong>FCRL5</strong> – Fc receptor–like 5; typically enriched in antigen-experienced B cell subsets, including age-associated B cells and some plasma cell subsets.<br>
- <strong>APOBEC3A</strong> – cytidine deaminase; often interferon-inducible, seen in activated myeloid and some activated B/ASC states; suggests an inflammatory/IFN-exposed environment.<br>
- <strong>LILRB4 (ILT3)</strong> – inhibitory receptor more classical in myeloid/dendritic cells but can appear in tolerogenic or specialized immune subsets; here likely secondary/low-level.<br>
<br>
<ul>
<li>Key cell-type–defining markers and their meaning  </li>
</ul>
<br>
- Plasma cell / antibody-secreting cell markers<br>
- Massive immunoglobulin transcription: <strong>IGHG1, IGHG3, IGHM, IGHA1, IGHA2, IGKC, IGLC2, IGLC3, etc.</strong> – signature of plasma cells rather than naive or memory B cells (where Ig genes are abundant but not so overwhelmingly dominant).<br>
- <strong>JCHAIN</strong> – specific for secretory IgA/IgM production; plasma cell hallmark in mucosal tissue.<br>
- <strong>MZB1, DERL3, TXNDC5</strong> – classic secretory/plasma cell machinery genes.<br>
- <strong>TNFRSF17 (BCMA)</strong> – highly characteristic of plasmablasts/plasma cells; not expressed on naive B cells and weak on most memory B cells.<br>
<br>
Together, these markers tightly define the cluster as antibody-secreting cells / plasma cells (ASCs), not memory or naive B cells.<br>
<br>
- Mucosal / IgA plasma cell markers<br>
- <strong>IGHA1, IGHA2</strong> – strong representation of α constant regions compatible with IgA-secreting ASCs.<br>
- <strong>JCHAIN</strong> – required for dimeric IgA, a defining feature of mucosal antibody responses.<br>
- <strong>CCR10</strong> – classical marker of IgA+ mucosal plasma cells (CCR10–CCL28 axis driving homing to colon and other mucosae).<br>
<br>
<ul>
<li>Cross-reference with scRNA-seq databases and literature  </li>
</ul>
<br>
- Human colon / intestine references (e.g., HCA Gut Cell Atlas, Smillie et al. Cell 2019, Martin et al. Nature 2019, Azimuth/Seurat colon references) consistently annotate clusters with:<br>
- Extremely high Ig gene expression (various IGH/IGK/IGL), <strong>MZB1</strong>, <strong>JCHAIN</strong>, <strong>TNFRSF17</strong>, <strong>XBP1/PRDM1</strong> (the latter not listed here but typically present) as <strong>plasma cells / plasmablasts</strong>.<br>
- <strong>CCR10+ IGHA1/2+ JCHAIN+</strong> clusters in colon are specifically labeled as <strong>mucosal IgA plasma cells</strong>.<br>
- Databases like CellTypist, SingleR using human PBMC + tissue B cell references:<br>
- A combination of <strong>TNFRSF17, MZB1, JCHAIN, high Ig constant regions</strong> maps robustly to &quot;plasmablast&quot;, &quot;plasma cell&quot;, or &quot;antibody-secreting cell&quot; annotations.<br>
- The overlap of <strong>CCR10 + IGHA1/IGHA2 + JCHAIN</strong> is classic for <strong>colonic lamina propria IgA-secreting plasma cells</strong>, which dominate B-lineage cells in large intestine.<br>
<br>
<ul>
<li>Most probable general cell type  </li>
</ul>
<br>
Given:<br>
- Dominant immune-globulin expression (heavy and light chains).<br>
- Presence of <strong>JCHAIN</strong>, <strong>MZB1</strong>, and <strong>TNFRSF17</strong>.<br>
- Absence (in the marker list) of canonical naive/memory B-cell-surface markers (MS4A1/CD20, CCR7, etc.) but instead a heavily secretory transcriptional program.<br>
<br>
→ The general cell type is: <strong>Plasma cell / antibody-secreting cell (ASC)</strong>.<br>
<br>
<ul>
<li>Top 3 most probable sub–cell-type annotations (ranked)  </li>
</ul>
<br>
Within plasma cells from large intestine, plausible subtypes based on these markers:<br>
<br>
<strong>1) Mucosal IgA-secreting plasma cells (CCR10+ IgA+ JCHAIN+ ASCs)</strong> – most likely<br>
- Supporting markers:<br>
- <strong>IGHA1, IGHA2</strong> – strong IgA usage.<br>
- <strong>JCHAIN</strong> – dimeric IgA production.<br>
- <strong>CCR10</strong> – gut/mucosal homing chemokine receptor; canonical for IgA+ plasma cells in colon and other mucosae.<br>
- <strong>TNFRSF17, MZB1, DERL3, TXNDC5</strong> – defining plasma cell machinery and survival.<br>
- Context: Large intestine lamina propria is dominated by IgA-secreting CCR10+ JCHAIN+ plasma cells that provide mucosal immunity (often identified as &quot;IgA plasma cells&quot; in colon atlases).<br>
- The co-expression of IgG and IgM genes is not unusual in a plasma-cell cluster; single-cell clusters can include multiple isotypes, but the combination of strong IgA + JCHAIN + CCR10 in colon strongly biases toward mucosal IgA ASCs as the primary identity.<br>
<br>
<strong>2) Class-switched IgG/IgM plasma cells (non-IgA dominant ASCs)</strong> – second most likely<br>
- Supporting markers:<br>
- <strong>IGHG1, IGHG3, IGHM</strong> alongside IgA genes.<br>
- Same plasma cell machinery (<strong>TNFRSF17, MZB1, DERL3</strong>).<br>
- Some colonic ASCs are IgG+ or IgM+ (responding to systemic or localized inflammation).<br>
- If the underlying data showed relatively stronger IGHG/IGHM than IGHA, this would argue for an IgG/IgM plasma cell subset; however, the presence of CCR10 and JCHAIN is more stereotypical of IgA mucosal cells, so this is considered secondary.<br>
<br>
<strong>3) Activated/inflammatory plasmablast-like plasma cells</strong> – third most likely<br>
- Supporting markers:<br>
- <strong>CCL3</strong> – produced by activated B cells/plasmablasts in inflammatory conditions.<br>
- <strong>APOBEC3A</strong> – IFN- and inflammation-associated; can mark activated ASCs, especially in inflamed tissue.<br>
- <strong>FCRL5</strong> – associated with antigen-experienced B-lineage states (e.g., age-associated B cells) and some inflammatory plasma cell subsets.<br>
- In the context of gut inflammation (e.g., IBD), one often sees more proliferative / plasmablast-like populations with such signatures.<br>
- However, the marker set lacks strong proliferation markers (MKI67, TOP2A, etc.), so I would not prioritize plasmablast over mature tissue plasma cell as the primary annotation.<br>
<br>
<strong>Most likely subtype:</strong><br>
<strong>CCR10+ IgA-secreting mucosal plasma cell</strong> (JCHAIN+ IgA ASC from colonic lamina propria).<br>
<br>
<ul>
<li>Concise summary  </li>
</ul>
<br>
- The cluster shows overwhelmingly high expression of diverse Ig heavy and light chain genes (IGHG1, IGHA1/2, IGHM, IGKC, IGLC2/3, etc.), together with <strong>JCHAIN</strong>, <strong>MZB1</strong>, and <strong>TNFRSF17</strong>, unequivocally identifying it as a <strong>plasma cell / antibody-secreting cell</strong> population.<br>
- The co-expression of <strong>IGHA1, IGHA2, JCHAIN, and CCR10</strong> in large intestine strongly indicates <strong>mucosal IgA-secreting plasma cells</strong> homing to and residing in the colonic lamina propria.<br>
- Additional markers (<strong>CCL3, APOBEC3A, FCRL5</strong>) suggest some degree of activation/inflammation but do not override the dominant mucosal IgA plasma cell identity.<br>
<br>
<strong>Final annotation:</strong><br>
- General: <strong>Plasma cell / antibody-secreting cell (ASC)</strong><br>
- Specific: <strong>CCR10+ IgA-secreting mucosal plasma cell (JCHAIN+ colonic lamina propria plasma cell)</strong><br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Plasma cell / antibody-secreting cell (ASC)</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">Mucosal IgA-secreting plasma cells (CCR10+ IgA+ JCHAIN+ ASCs)</li><li class="rank-2">Class-switched IgG/IgM plasma cells (non-IgA dominant ASCs)</li><li class="rank-3">Activated/inflammatory plasmablast-like plasma cells</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li class="empty">None identified</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-5">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">transit amplifying cell of large intestine</h2>
                <p class="modal-subtitle">Predicted: <strong>Cycling intestinal epithelial cells (crypt progenitor/TA compartment)</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">HJURP, UBE2C, CENPA, PBK, AURKB, DLGAP5, CKAP2L, KIF2C, KIF15, BIRC5, SPC25, ASPM, KIF18B, CEP55, DEPDC1, MKI67, CDC45, CDCA5, TOP2A, PCLAF, MND1, RRM2, ZNF695, CCNB2, NUF2, SKA3, SPC24, DTL, PKMYT1, CDCA3, TTK, DIAPH3, PLK1, IQGAP3, CDK1, TK1, POLQ, GTSE1, OIP5, FOXM1, TROAP, SKA1, NEK2, CDC25C, NCAPG, PIMREG, GINS2, RAD51AP1, CDT1, CCNA2</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    …Given the tissue source (large intestine) and known biology of the colonic crypt, the most coherent interpretation is that this cluster represents <strong>crypt epithelial progenitors in an active G2/M cell-cycle state</strong>, i.e. the <strong>transit-amplifying compartment</strong> rather than differentiated or non-epithelial lineages.<br>
<br>
<strong>Final annotation</strong><br>
<br>
- <strong>General cell type:</strong><br>
- Intestinal epithelial cells (large intestine), <strong>cycling / proliferative</strong><br>
<br>
- <strong>Most probable subtype (ranked)</strong><br>
1. <strong>Cycling transit-amplifying (TA) epithelial cells, G2/M-enriched</strong> – best fit to the pure cell-cycle signature, matching TA clusters in human colon atlases.<br>
2. Cycling intestinal stem (CBC) cells – possible but less likely due to absence of prominent Wnt/stemness markers (LGR5, ASCL2, OLFM4, SMOC2, AXIN2).<br>
3. Other cycling lineages (immune, stromal, endothelial) – unlikely given the lack of canonical lineage markers (CD3D/E, CD79A, COL1A1, PECAM1, etc.).<br>
<br>
<strong>Concise label to use in the object metadata:</strong><br>
<br>
&gt; <strong>“Cycling transit-amplifying epithelial cells (G2/M, colonic crypt)”</strong><br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Cycling intestinal epithelial cells (crypt progenitor/TA compartment)</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li class="rank-1">Cycling transit-amplifying (TA) epithelial cells of the colonic crypt</li><li class="rank-2">Cycling intestinal stem cells (crypt base columnar, CBC)</li><li class="rank-3">Cycling immune or stromal cells (e.g., proliferating T cells, B cells, fibroblasts, endothelial)</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li>Cycling transit-amplifying (TA) epithelial cells of the colonic crypt and cycling intestinal stem cells (crypt base columnar, CBC)</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            

            
        </div>
    </div>
    
        </div>
    </div>

    <script>

    let currentModalIndex = null;

    function openModal(index) {
        const overlay = document.getElementById('modal-overlay');
        const allContents = document.querySelectorAll('.modal-content');

        allContents.forEach(c => c.classList.remove('active'));

        const content = document.getElementById('modal-content-' + index);
        if (content) {
            content.classList.add('active');
            overlay.classList.add('active');
            currentModalIndex = index;
            document.body.style.overflow = 'hidden';
        }
    }

    function closeModal() {
        const overlay = document.getElementById('modal-overlay');
        overlay.classList.remove('active');
        currentModalIndex = null;
        document.body.style.overflow = '';
    }

    // Close modal on overlay click
    document.getElementById('modal-overlay').addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal();
        }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && currentModalIndex !== null) {
            closeModal();
        }
    });

    // Search functionality
    function filterCards() {
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        const tissueFilter = document.getElementById('filter-tissue').value;
        const speciesFilter = document.getElementById('filter-species').value;
        const modelFilter = document.getElementById('filter-model').value;
        const providerFilter = document.getElementById('filter-provider').value;

        const cards = document.querySelectorAll('.cluster-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const text = card.textContent.toLowerCase();
            const tissue = card.dataset.tissue;
            const species = card.dataset.species;
            const model = card.dataset.model;
            const provider = card.dataset.provider;

            const matchesSearch = searchTerm === '' || text.includes(searchTerm);
            const matchesTissue = tissueFilter === '' || tissue === tissueFilter;
            const matchesSpecies = speciesFilter === '' || species === speciesFilter;
            const matchesModel = modelFilter === '' || model === modelFilter;
            const matchesProvider = providerFilter === '' || provider === providerFilter;

            if (matchesSearch && matchesTissue && matchesSpecies && matchesModel && matchesProvider) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        // Show/hide no results message
        const noResults = document.getElementById('no-results');
        if (noResults) {
            noResults.style.display = visibleCount === 0 ? 'block' : 'none';
        }

        // Update visible count
        const countEl = document.getElementById('visible-count');
        if (countEl) {
            countEl.textContent = visibleCount;
        }
    }

    // Clear filters
    function clearFilters() {
        document.getElementById('search-input').value = '';
        document.getElementById('filter-tissue').value = '';
        document.getElementById('filter-species').value = '';
        document.getElementById('filter-model').value = '';
        document.getElementById('filter-provider').value = '';
        filterCards();
    }

    // Export to PDF (print)
    function exportToPDF() {
        window.print();
    }

    // Initialize search input listener
    document.getElementById('search-input').addEventListener('input', filterCards);
    
    </script>
</body>
</html>