{"version":136,"schema_version":1,"doc":{"type":"doc","attrs":{"table_of_contents":{"enabled":true,"allowedLevels":[1,2,3]}},"content":[{"type":"heading","attrs":{"level":2,"guid":"m1802oop"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"Table of Contents"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"1. Introduction"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"2. Prerequisites"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"3. Script Overview"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4. Key Components"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"   4.1 Agent Class"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"   4.2 Conversation Functions"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"   4.3 Data Processing Functions"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"   4.4 Specialized Agents"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"5. Main Execution Flow"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"6. Output"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"7. Customization and Extension"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"8. Troubleshooting"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"9. Conclusion"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1802qyj"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"1. Introduction"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"This script implements a multi-agent system for analyzing single-cell data. It uses a series of AI agents to perform functional analysis, cell type identification, and integrative annotation of gene markers."}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1802sud"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"2. Prerequisites"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Python 3.x"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Required libraries: `openai`, `dotenv`, `httpx`, `re`, `os`, `json`"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- OpenAI API key (set in environment variables)"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1802v3l"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"3. Script Overview"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"The script performs the following high-level steps:"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"1. Onboarding process to gather initial information"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"2. Functional analysis of gene markers"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"3. Cell type analysis of gene markers"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4. Integrative analysis combining results from steps 2 and 3"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"5. Formatting and structuring the final output"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m18033u1"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4. Key Components"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"guid":"m180354x"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4.1 Agent Class"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"The `Agent` class is the core component of the script. It represents an AI agent capable of engaging in conversations and performing specific tasks."}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"Key features:"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Initialization with system prompt, model, and interaction settings"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Conversation history management"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Execution of AI model queries"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Human input handling"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"guid":"m18037gz"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4.2 Conversation Functions"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `two_agent_conversation_with_validation_celltype`: Manages the conversation for cell type analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `two_agent_conversation_with_validation_functional`: Manages the conversation for functional analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `integrate_and_annotate`: Handles the integrative analysis conversation"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `onboarding_process`: Gathers initial information from the user"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"guid":"m180398o"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4.3 Data Processing Functions"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `extract_agent1_analysis`: Extracts analysis results from conversation history"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `extract_json_from_reply`: Parses JSON data from agent responses"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `list_to_comma_separated_string`: Converts list to comma-separated string"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `construct_prompt`: Builds the initial prompt based on user input"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":3,"guid":"m1803ari"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4.4 Specialized Agents"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"The script defines several specialized agents:"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `agent1_functional` and `agent2_functional`: For functional analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `agent1_celltype` and `agent2_celltype`: For cell type analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `agent3`: For onboarding"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `integrative_agent`: For integrative analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- `formatting_agent`: For formatting final results"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1803cgd"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"5. Main Execution Flow"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"1. Start onboarding process"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"2. Conduct functional analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"3. Perform cell type analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"4. Execute integrative analysis"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"5. Format and structure final results"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1803ebm"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"6. Output"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"The script produces a structured JSON output containing:"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Main cell type identified"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Sub-cell types (if applicable)"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1803fsm"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"7. Customization and Extension"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Modify agent system prompts to adjust behavior"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Add new specialized agents for additional analyses"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Extend the `Agent` class for more complex interactions"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1803hdg"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"8. Troubleshooting"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Ensure all required libraries are installed"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Verify that the OpenAI API key is correctly set in environment variables"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"- Check for any rate limiting or API usage issues with OpenAI"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2,"guid":"m1803jlz"},"content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"9. Conclusion"}]},{"type":"paragraph","content":[{"type":"text","marks":[{"type":"author_id","attrs":{"authorId":"18543197257"}}],"text":"This script provides a flexible framework for single-cell data analysis using AI agents. It can be adapted and extended for various types of biological data analysis tasks."}]}]},"savepoint_metadata":{"savepointFileId":"1650401769122","savepointsInfo":{"133":{"timestamp":1726672326217,"type":"session","authorsSinceLastSavepoint":["18543197257"]}},"shouldCreateSavepointBeforeApplyingNextVersion":false,"authorsSinceLastSavepoint":{"18543197257":true},"allAuthorNames":{"18543197257":"Elliot Xie"}},"last_edit_timestamp":1726682416473}