<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CASSIA Batch Analysis Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>

    :root {
        --primary: #0d9488;
        --primary-light: #14b8a6;
        --primary-dark: #0f766e;
        --secondary: #059669;
        --accent: #f59e0b;
        --accent-light: #fbbf24;
        --background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 50%, #f0fdf4 100%);
        --surface: rgba(255, 255, 255, 0.85);
        --surface-hover: rgba(255, 255, 255, 0.95);
        --text-primary: #134e4a;
        --text-secondary: #64748b;
        --text-muted: #94a3b8;
        --border: rgba(13, 148, 136, 0.15);
        --shadow: 0 8px 32px rgba(13, 148, 136, 0.12);
        --shadow-hover: 0 12px 40px rgba(13, 148, 136, 0.2);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
        background: var(--background);
        min-height: 100vh;
        color: var(--text-primary);
        line-height: 1.6;
    }

    .container {
        max-width: 1600px;
        margin: 0 auto;
        padding: 20px;
    }

    /* Header */
    .report-header {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        padding: 40px;
        border-radius: 24px;
        margin-bottom: 30px;
        box-shadow: var(--shadow);
        position: relative;
        overflow: hidden;
    }

    .report-header::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 100%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
        pointer-events: none;
    }

    .header-content {
        position: relative;
        z-index: 1;
    }

    .report-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin-bottom: 8px;
        letter-spacing: -0.5px;
    }

    .report-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
        font-weight: 400;
    }

    .report-meta {
        display: flex;
        gap: 24px;
        margin-top: 20px;
        flex-wrap: wrap;
    }

    .meta-badge {
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.2);
        padding: 8px 16px;
        border-radius: 12px;
        font-size: 0.9rem;
        backdrop-filter: blur(10px);
    }

    /* Stats Bar */
    .stats-bar {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 16px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        text-align: center;
        box-shadow: var(--shadow);
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        line-height: 1;
    }

    .stat-label {
        font-size: 0.85rem;
        color: var(--text-secondary);
        margin-top: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    /* Controls */
    .controls-bar {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 30px;
        display: flex;
        flex-wrap: wrap;
        gap: 16px;
        align-items: center;
        box-shadow: var(--shadow);
    }

    .search-box {
        flex: 1;
        min-width: 250px;
        position: relative;
    }

    .search-box input {
        width: 100%;
        padding: 12px 16px 12px 44px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 1rem;
        background: white;
        color: var(--text-primary);
        transition: all 0.3s ease;
    }

    .search-box input:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(13, 148, 136, 0.1);
    }

    .search-box svg {
        position: absolute;
        left: 14px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
    }

    .filter-select {
        padding: 12px 16px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 0.9rem;
        background: white;
        color: var(--text-primary);
        cursor: pointer;
        min-width: 140px;
        transition: all 0.3s ease;
    }

    .filter-select:focus {
        outline: none;
        border-color: var(--primary);
    }

    .btn {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 12px 20px;
        border: none;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(13, 148, 136, 0.3);
    }

    .btn-secondary {
        background: white;
        color: var(--text-primary);
        border: 2px solid var(--border);
    }

    .btn-secondary:hover {
        border-color: var(--primary);
        color: var(--primary);
    }

    /* Cluster Grid */
    .cluster-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
        gap: 24px;
    }

    .cluster-card {
        background: var(--surface);
        backdrop-filter: blur(10px);
        border: 1px solid var(--border);
        border-radius: 20px;
        padding: 24px;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .cluster-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-hover);
        border-color: var(--primary-light);
        background: var(--surface-hover);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
    }

    .cluster-name {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-primary);
        line-height: 1.3;
    }

    .card-badges {
        display: flex;
        gap: 6px;
        flex-shrink: 0;
    }

    .badge {
        padding: 4px 10px;
        border-radius: 8px;
        font-size: 0.75rem;
        font-weight: 600;
        white-space: nowrap;
    }

    .badge-markers {
        background: linear-gradient(135deg, var(--primary-light), var(--primary));
        color: white;
    }

    .badge-iterations {
        background: linear-gradient(135deg, var(--accent-light), var(--accent));
        color: white;
    }

    .card-main-type {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.08), rgba(5, 150, 105, 0.08));
        border-radius: 12px;
        padding: 16px;
        border-left: 4px solid var(--primary);
    }

    .main-type-label {
        font-size: 0.8rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: block;
        margin-bottom: 4px;
    }

    .main-type-value {
        font-size: 1.15rem;
        font-weight: 700;
        color: var(--primary-dark);
    }

    .card-section {
        padding: 0;
    }

    .section-label {
        font-size: 0.8rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .sub-types-list {
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .sub-types-list li {
        font-size: 0.9rem;
        color: var(--text-primary);
        padding-left: 16px;
        position: relative;
    }

    .sub-types-list li::before {
        content: '';
        position: absolute;
        left: 0;
        top: 8px;
        width: 6px;
        height: 6px;
        background: var(--secondary);
        border-radius: 50%;
    }

    .sub-types-list li.more {
        color: var(--text-muted);
        font-style: italic;
    }

    .sub-types-list li.more::before {
        background: var(--text-muted);
    }

    .empty-field {
        color: var(--text-muted);
        font-style: italic;
        font-size: 0.9rem;
    }

    .card-field {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        font-size: 0.85rem;
        color: var(--text-secondary);
    }

    .card-field .field-icon {
        color: var(--primary);
        flex-shrink: 0;
        margin-top: 2px;
    }

    .card-field .field-label {
        font-weight: 600;
        white-space: nowrap;
    }

    .card-meta {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 12px;
        background: rgba(100, 116, 139, 0.05);
        border-radius: 10px;
    }

    .meta-row {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
    }

    .meta-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .meta-item svg {
        color: var(--primary);
    }

    .card-markers {
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .markers-label {
        font-weight: 600;
    }

    .markers-preview {
        color: var(--text-muted);
        word-break: break-word;
    }

    .view-analysis-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        width: 100%;
        padding: 14px 20px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        border: none;
        border-radius: 12px;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: auto;
    }

    .view-analysis-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(13, 148, 136, 0.3);
    }

    /* Modal */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(8px);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        padding: 20px;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .modal-overlay.active {
        display: flex;
        opacity: 1;
    }

    .modal-container {
        background: white;
        border-radius: 24px;
        max-width: 900px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
        animation: modalSlideIn 0.3s ease;
    }

    @keyframes modalSlideIn {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .modal-content {
        display: none;
    }

    .modal-content.active {
        display: block;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: 28px 32px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
    }

    .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 4px;
    }

    .modal-subtitle {
        font-size: 1rem;
        opacity: 0.9;
    }

    .modal-close {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        color: white;
        font-size: 1.8rem;
        width: 40px;
        height: 40px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
    }

    .modal-close:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: rotate(90deg);
    }

    .modal-body {
        padding: 28px 32px;
        max-height: calc(90vh - 120px);
        overflow-y: auto;
    }

    .markers-full {
        background: rgba(13, 148, 136, 0.05);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 24px;
        border-left: 4px solid var(--primary);
    }

    .markers-full h4 {
        font-size: 0.85rem;
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 8px;
    }

    .markers-text {
        font-size: 0.9rem;
        color: var(--text-primary);
        word-break: break-word;
        line-height: 1.7;
    }

    .modal-section {
        margin-bottom: 24px;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid var(--border);
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 16px 20px;
        font-size: 1.05rem;
        font-weight: 600;
        margin: 0;
    }

    .section-content {
        padding: 20px;
        background: white;
        font-size: 0.95rem;
        line-height: 1.8;
    }

    .annotation-section .section-title {
        background: linear-gradient(135deg, rgba(13, 148, 136, 0.1), rgba(13, 148, 136, 0.05));
        color: var(--primary-dark);
    }

    .validator-section .section-title {
        background: linear-gradient(135deg, rgba(5, 150, 105, 0.1), rgba(5, 150, 105, 0.05));
        color: #047857;
    }

    .formatting-section .section-title {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05));
        color: #b45309;
    }

    .scoring-section .section-title {
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.05));
        color: #4338ca;
    }

    .validation-status {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 16px;
        border-radius: 10px;
        font-weight: 600;
        margin-bottom: 12px;
    }

    .validation-status.passed {
        background: rgba(5, 150, 105, 0.1);
        color: #047857;
    }

    .validation-status.failed {
        background: rgba(239, 68, 68, 0.1);
        color: #dc2626;
    }

    .validator-content {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    .json-summary {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .summary-field {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .summary-field .field-label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: var(--accent);
        font-weight: 600;
    }

    .summary-field .field-value {
        color: var(--text-primary);
    }

    .summary-field .main-type {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-dark);
    }

    .type-list {
        list-style: none;
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

    .type-list li {
        padding: 8px 12px;
        background: rgba(13, 148, 136, 0.05);
        border-radius: 8px;
        font-size: 0.9rem;
    }

    .type-list li.empty {
        color: var(--text-muted);
        font-style: italic;
        background: rgba(100, 116, 139, 0.05);
    }

    .json-raw {
        background: #1e293b;
        color: #e2e8f0;
        padding: 16px;
        border-radius: 8px;
        font-size: 0.85rem;
        overflow-x: auto;
    }

    .step-header {
        color: var(--primary);
        font-size: 1rem;
        margin-top: 20px;
        margin-bottom: 10px;
        padding-bottom: 6px;
        border-bottom: 2px solid rgba(13, 148, 136, 0.2);
    }

    .section-content h2, .section-content h3, .section-content h4 {
        color: var(--text-primary);
        margin-top: 16px;
        margin-bottom: 8px;
    }

    .section-content ul {
        margin: 12px 0;
        padding-left: 24px;
    }

    .section-content li {
        margin-bottom: 6px;
    }

    .section-content p {
        margin-bottom: 12px;
    }

    .section-content strong {
        color: var(--text-primary);
    }

    /* Print Styles */
    @media print {
        .controls-bar,
        .view-analysis-btn,
        .modal-overlay {
            display: none !important;
        }

        .cluster-card {
            break-inside: avoid;
            box-shadow: none;
            border: 1px solid #ddd;
        }

        .report-header {
            background: var(--primary) !important;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .container {
            padding: 12px;
        }

        .report-header {
            padding: 24px;
            border-radius: 16px;
        }

        .report-title {
            font-size: 1.8rem;
        }

        .cluster-grid {
            grid-template-columns: 1fr;
        }

        .controls-bar {
            flex-direction: column;
        }

        .search-box {
            width: 100%;
        }

        .filter-select {
            width: 100%;
        }

        .modal-container {
            max-height: 95vh;
            border-radius: 16px;
        }

        .modal-header {
            padding: 20px;
        }

        .modal-body {
            padding: 20px;
        }
    }

    /* No results message */
    .no-results {
        text-align: center;
        padding: 60px 20px;
        color: var(--text-secondary);
    }

    .no-results svg {
        width: 64px;
        height: 64px;
        color: var(--text-muted);
        margin-bottom: 16px;
    }

    .no-results h3 {
        font-size: 1.2rem;
        margin-bottom: 8px;
        color: var(--text-primary);
    }
    
    </style>
</head>
<body>
    <div class="container">
        <header class="report-header">
            <div class="header-content">
                <h1 class="report-title">CASSIA Batch Analysis Report</h1>
                <p class="report-subtitle">Comprehensive Cell Type Annotation Analysis</p>
                <div class="report-meta">
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        2025-11-25 18:26:43
                    </span>
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        large intestine
                    </span>
                    <span class="meta-badge">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M2 12h20"></path>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                        human
                    </span>
                </div>
            </div>
        </header>

        <div class="stats-bar">
            <div class="stat-card">
                <div class="stat-value">2</div>
                <div class="stat-label">Total Clusters</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="visible-count">2</div>
                <div class="stat-label">Showing</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">1</div>
                <div class="stat-label">Tissues</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">1</div>
                <div class="stat-label">Models</div>
            </div>
        </div>

        <div class="controls-bar">
            <div class="search-box">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="M21 21l-4.35-4.35"></path>
                </svg>
                <input type="text" id="search-input" placeholder="Search clusters, cell types, markers...">
            </div>
            <select class="filter-select" id="filter-tissue" onchange="filterCards()">
                <option value="">All Tissues</option><option value="large intestine">large intestine</option>
            </select>
            <select class="filter-select" id="filter-species" onchange="filterCards()">
                <option value="">All Species</option><option value="human">human</option>
            </select>
            <select class="filter-select" id="filter-model" onchange="filterCards()">
                <option value="">All Models</option><option value="google/gemini-2.5-flash">google/gemini-2.5-flash</option>
            </select>
            <select class="filter-select" id="filter-provider" onchange="filterCards()">
                <option value="">All Providers</option><option value="openrouter">openrouter</option>
            </select>
            <button class="btn btn-secondary" onclick="clearFilters()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M18 6L6 18"></path>
                    <path d="M6 6l12 12"></path>
                </svg>
                Clear
            </button>
            <button class="btn btn-primary" onclick="exportToPDF()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Export PDF
            </button>
        </div>

        <div class="cluster-grid">
            
    <div class="cluster-card" data-index="0" data-cluster="Dendritic cells"
         data-maintype="Proliferating Cells" data-tissue="large intestine" data-species="human"
         data-model="google/gemini-2.5-flash" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">Dendritic cells</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">15 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Proliferating Cells</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li>Transit Amplifying (TA) Cells</li><li>Intestinal Stem Cells (ISCs) / Crypt Base Columnar (CBC) Cells</li><li>Early Progenitor Cells (Undifferentiated)</li></ul>
        </div>

        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    google/gemini-2.5-flash
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">LARS, FAM127A, THEM4, SHOC2, ACAT2, WNK1, UTP6, ATP5SL, GLB1, PLA2G12A, MIS18BP1...</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(0)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    

    <div class="cluster-card" data-index="1" data-cluster="FCGR3A+ Monocytes"
         data-maintype="Pan-cellular / Undifferentiated / Metabolically Active Cells" data-tissue="large intestine" data-species="human"
         data-model="google/gemini-2.5-flash" data-provider="openrouter">
        <div class="card-header">
            <h3 class="cluster-name">FCGR3A+ Monocytes</h3>
            <div class="card-badges">
                <span class="badge badge-markers" title="Number of markers">6 markers</span>
                <span class="badge badge-iterations" title="Iterations">1 iter</span>
            </div>
        </div>

        <div class="card-main-type">
            <span class="main-type-label">Predicted:</span>
            <span class="main-type-value">Pan-cellular / Undifferentiated / Metabolically Active Cells</span>
        </div>

        <div class="card-section">
            <div class="section-label">Sub Cell Types:</div>
            <ul class="sub-types-list"><li>Undifferentiated/Progenitor Cells</li><li>Highly Metabolically Active Differentiated Cells</li><li>General Stromal Cells</li></ul>
        </div>

        

        <div class="card-meta">
            <div class="meta-row">
                <span class="meta-item" title="Model">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                    google/gemini-2.5-flash
                </span>
                <span class="meta-item" title="Provider">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 12h-4l-3 9L9 3l-3 9H2"></path>
                    </svg>
                    openrouter
                </span>
            </div>
            <div class="meta-row">
                <span class="meta-item" title="Tissue">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                    </svg>
                    large intestine
                </span>
                <span class="meta-item" title="Species">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M2 12h20"></path>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    human
                </span>
            </div>
        </div>

        <div class="card-markers">
            <span class="markers-label">Markers:</span>
            <span class="markers-preview">CPSF3L, ALG5, CYTH2, PSMC6, WNK1, ERI3</span>
        </div>

        

        <button class="view-analysis-btn" onclick="openModal(1)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View Full Analysis
        </button>
    </div>
    
        </div>

        <div id="no-results" class="no-results" style="display: none;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
            </svg>
            <h3>No clusters found</h3>
            <p>Try adjusting your search or filters</p>
        </div>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal-container">
            
    <div class="modal-content" id="modal-content-0">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">Dendritic cells</h2>
                <p class="modal-subtitle">Predicted: <strong>Proliferating Cells</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">LARS, FAM127A, THEM4, SHOC2, ACAT2, WNK1, UTP6, ATP5SL, GLB1, PLA2G12A, MIS18BP1, MRPL42, BRWD1, PCNA, CSRP1</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    Here&#x27;s a detailed analysis to identify the cell type based on the provided marker list:<br>
<br>
<strong>Step 1: List the Key Functional Markers</strong><br>
<br>
<em>   <strong>LARS (Leucyl-tRNA Synthetase):</strong> Essential for protein synthesis, catalyzing the ligation of leucine to its cognate tRNA. Highly expressed in rapidly proliferating cells or cells with high metabolic activity.<br>
</em>   <strong>FAM127A (Family With Sequence Similarity 127 Member A):</strong> While its precise function is not fully elucidated, it&#x27;s often associated with cell growth and proliferation, and has been implicated in various cancers.<br>
<em>   <strong>THEM4 (Thioesterase Superfamily Member 4):</strong> Also known as STARD14, involved in lipid metabolism and cell growth regulation. Its expression can be elevated in proliferating cells.<br>
</em>   <strong>SHOC2 (Scaffold Protein SHOC2):</strong> A scaffold protein involved in the RAS/MAPK signaling pathway, which is crucial for cell proliferation, differentiation, and survival. High expression suggests active signaling related to growth.<br>
<em>   <strong>ACAT2 (Acetyl-CoA Acetyltransferase 2):</strong> Involved in cholesterol synthesis and fatty acid metabolism. High expression can indicate active lipid synthesis, often associated with membrane biogenesis in dividing cells.<br>
</em>   <strong>WNK1 (WNK Lysine Deficient Protein Kinase 1):</strong> A serine/threonine kinase involved in ion transport and cell volume regulation. It also plays roles in cell proliferation and survival.<br>
<em>   <strong>UTP6 (UTP6 Small Subunit Processome Component):</strong> A component of the small subunit processome, essential for ribosomal RNA processing and ribosome biogenesis. High expression is a strong indicator of active protein synthesis and cell growth.<br>
</em>   <strong>ATP5SL (ATP Synthase F0 Subunit C Like 2):</strong> A component of mitochondrial ATP synthase, crucial for ATP production. Elevated levels suggest high energy demand, typical of metabolically active and proliferating cells.<br>
<em>   <strong>GLB1 (Beta-Galactosidase):</strong> Lysosomal enzyme involved in glycoprotein and glycolipid degradation. While primarily lysosomal, its expression can be modulated in various cellular states, sometimes linked to senescence or stress, but also generally present in metabolically active cells.<br>
</em>   <strong>PLA2G12A (Phospholipase A2 Group XIIA):</strong> Involved in phospholipid metabolism, potentially contributing to membrane remodeling, which is critical during cell division.<br>
<em>   <strong>MIS18BP1 (MIS18 Binding Protein 1):</strong> A component of the MIS18 complex, essential for centromere assembly and kinetochore formation, critical processes during mitosis. This is a very strong marker for cell division.<br>
</em>   <strong>MRPL42 (Mitochondrial Ribosomal Protein L42):</strong> A component of the mitochondrial ribosome, essential for mitochondrial protein synthesis. High expression indicates active mitochondrial function and energy production, supporting cell growth.<br>
<em>   <strong>BRWD1 (Bromodomain And WD Repeat Domain Containing 1):</strong> Involved in chromatin remodeling and gene regulation. Its role in cell cycle progression and proliferation has been noted.<br>
</em>   <strong>PCNA (Proliferating Cell Nuclear Antigen):</strong> A DNA clamp that acts as a processivity factor for DNA polymerase Î´ in eukaryotic cells. It is absolutely essential for DNA replication and repair. <strong>PCNA is a canonical and highly reliable marker for actively proliferating cells.</strong><br>
<em>   <strong>CSRP1 (Cysteine And Glycine Rich Protein 1):</strong> A LIM domain protein involved in cell differentiation, migration, and cytoskeleton organization. While sometimes associated with differentiation, its presence here in conjunction with strong proliferation markers might indicate cells undergoing rapid changes or early differentiation stages within a proliferative context.<br>
<br>
<strong>Step 2: List the Key Cell Type Markers</strong><br>
<br>
Given the general nature of most markers (related to proliferation and basic cellular functions), there are no immediately obvious </em>tissue-specific<em> or </em>terminally differentiated cell type-specific<em> markers in this list. Instead, the markers strongly point towards a </em>functional state<em> rather than a specific mature cell type.<br>
<br>
However, if we consider the context of the large intestine, cells that are highly proliferative include:<br>
</em>   <strong>Intestinal Stem Cells (ISCs):</strong> Located at the crypt base, responsible for continuous renewal of the intestinal epithelium.<br>
<em>   <strong>Transit Amplifying (TA) Cells:</strong> Progeny of ISCs, undergoing rapid division as they migrate up the crypt-villus axis before differentiating.<br>
<br>
<strong>Step 3: Cross-reference Known Databases</strong><br>
<br>
A quick search for these markers, particularly <strong>PCNA, MIS18BP1, UTP6, LARS, SHOC2</strong>, in scRNA-seq databases (e.g., Human Cell Atlas, specific large intestine datasets) consistently shows their high expression in:<br>
</em>   <strong>Proliferating cells:</strong> This is the most dominant theme.<br>
<em>   <strong>Stem cells and transit-amplifying cells:</strong> Especially in tissues with high turnover like the intestine, skin, and hematopoietic system.<br>
</em>   <strong>Cancer cells:</strong> Due to their uncontrolled proliferation.<br>
<br>
Specifically, in the large intestine, <strong>PCNA</strong> is a hallmark of crypt base columnar (CBC) stem cells and transit-amplifying cells. Genes involved in ribosome biogenesis (like UTP6, MRPL42) and protein synthesis (LARS) are also highly expressed in these rapidly dividing and growing cells. MIS18BP1&#x27;s role in centromere assembly further solidifies the proliferative nature.<br>
<br>
<strong>Step 4: Determine the Most Probable General Cell Type</strong><br>
<br>
Based on the overwhelming evidence from the key functional markers, particularly <strong>PCNA, MIS18BP1, UTP6, LARS, SHOC2, FAM127A, THEM4, ACAT2, WNK1, ATP5SL, MRPL42, BRWD1</strong>, the most probable general cell type is <strong>Proliferating Cells</strong>. These are cells actively undergoing the cell cycle, characterized by DNA replication, protein synthesis, and cell division.<br>
<br>
<strong>Step 5: Identify the Top 3 Most Probable Sub Cell Types</strong><br>
<br>
Considering the context of the large intestine, a tissue with high cellular turnover, and the strong proliferative signature:<br>
<br>
<ul>
<li> <strong>Most Likely: Transit Amplifying (TA) Cells:</strong> These cells are the immediate progeny of intestinal stem cells and undergo several rounds of rapid division as they migrate upwards in the crypt before differentiating. The high expression of a broad range of proliferation-associated genes (PCNA, MIS18BP1, ribosome biogenesis, protein synthesis, metabolic genes) is highly characteristic of TA cells, which are designed for rapid expansion.</li>
</ul>
<br>
<ul>
<li> <strong>Second Most Likely: Intestinal Stem Cells (ISCs) / Crypt Base Columnar (CBC) Cells:</strong> ISCs are also highly proliferative and express many of these markers. However, TA cells typically exhibit an even more pronounced and sustained proliferative gene expression program as they are undergoing rapid amplification. While ISCs are the ultimate source, TA cells represent the bulk of the rapidly dividing population in the crypt. The absence of specific ISC markers (e.g., Lgr5, Olfm4, Ascl2) makes it harder to definitively call them pure ISCs, but they are certainly part of the stem/progenitor compartment.</li>
</ul>
<br>
<ul>
<li> <strong>Third Most Likely: Early Progenitor Cells (Undifferentiated):</strong> This category broadly encompasses cells that are still highly proliferative and have not yet committed to a specific differentiation pathway (e.g., enterocytes, goblet cells, enteroendocrine cells). This is very similar to TA cells, but perhaps slightly less committed or further upstream.</li>
</ul>
<br>
<strong>Most Likely Subtype:</strong> <strong>Transit Amplifying (TA) Cells</strong><br>
<br>
The sheer breadth and intensity of proliferation-related markers (PCNA, MIS18BP1, UTP6, LARS, etc.) strongly point towards cells that are actively and rapidly dividing to expand their numbers. This is the defining characteristic of transit-amplifying cells in the intestinal crypt. While intestinal stem cells are also proliferative, TA cells represent the primary population undergoing rapid clonal expansion.<br>
<br>
<strong>Step 6: Provide a Concise Summary of Your Analysis</strong><br>
<br>
The provided marker list is overwhelmingly dominated by genes associated with cell proliferation, DNA replication, ribosome biogenesis, and active metabolism. Key markers like <strong>PCNA</strong> (DNA replication), <strong>MIS18BP1</strong> (centromere assembly/mitosis), <strong>UTP6</strong> (ribosome biogenesis), and <strong>LARS</strong> (protein synthesis) are canonical indicators of actively dividing cells. In the context of the large intestine, a tissue characterized by continuous epithelial renewal, this gene expression profile is highly characteristic of cells within the proliferative compartment of the intestinal crypts. Therefore, the most probable general cell type is <strong>Proliferating Cells</strong>. Among the specific subtypes in the large intestine, <strong>Transit Amplifying (TA) Cells</strong> are the most likely annotation, given their role in rapid clonal expansion from stem cells, followed by Intestinal Stem Cells and early progenitor cells.<br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Proliferating Cells</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li>Transit Amplifying (TA) Cells</li><li>Intestinal Stem Cells (ISCs) / Crypt Base Columnar (CBC) Cells</li><li>Early Progenitor Cells (Undifferentiated)</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li class="empty">None identified</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            
        </div>
    </div>
    

    <div class="modal-content" id="modal-content-1">
        <div class="modal-header">
            <div class="modal-title-section">
                <h2 class="modal-title">FCGR3A+ Monocytes</h2>
                <p class="modal-subtitle">Predicted: <strong>Pan-cellular / Undifferentiated / Metabolically Active Cells</strong></p>
            </div>
            <button class="modal-close" onclick="closeModal()">&times;</button>
        </div>

        <div class="modal-body">
            <div class="markers-full">
                <h4>Full Marker List:</h4>
                <p class="markers-text">CPSF3L, ALG5, CYTH2, PSMC6, WNK1, ERI3</p>
            </div>

            <div class="modal-section annotation-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="M21 21l-4.35-4.35"></path>
                    </svg>
                    Annotation Analysis
                </h3>
                <div class="section-content">
                    Okay, I will meticulously analyze the provided marker list from a human large intestine scRNA-seq dataset to identify the cell type. I will follow the requested step-by-step process, providing a comprehensive and specific analysis for an expert audience.<br>
<br>
<strong>Marker List:</strong> CPSF3L, ALG5, CYTH2, PSMC6, WNK1, ERI3 (ranked from high to low expression)<br>
<br>
---<br>
<br>
<h4>Step 1: List the Key Functional Markers</h4>
<br>
Upon reviewing the provided gene list, it&#x27;s immediately apparent that these genes are predominantly involved in fundamental cellular processes rather than highly specific, cell-type-defining functions or pathways. This suggests a ubiquitous expression pattern, which can be challenging for direct cell type identification.<br>
<br>
<em>   <strong>CPSF3L (Cleavage and Polyadenylation Specific Factor 3 Like):</strong> This gene is a component of the CPSF complex, which is crucial for the 3&#x27;-end processing of pre-mRNAs, including cleavage and polyadenylation. This process is essential for mRNA stability, translation, and export. <strong>Role:</strong> Fundamental mRNA processing.<br>
</em>   <strong>ALG5 (Asparagine-linked Glycosylation 5):</strong> This gene encodes a dolichyl-phosphate mannosyltransferase, an enzyme involved in the synthesis of dolichyl-phosphate-mannose, which is a substrate for N-linked glycosylation in the endoplasmic reticulum. N-linked glycosylation is a critical post-translational modification for many secreted and membrane proteins. <strong>Role:</strong> Protein glycosylation, ER function.<br>
<em>   <strong>CYTH2 (Cytohesin 2):</strong> This gene encodes a guanine nucleotide exchange factor (GEF) for ARF (ADP-ribosylation factor) GTPases. ARF proteins are involved in membrane trafficking, vesicle budding, and cytoskeletal organization. <strong>Role:</strong> Membrane trafficking, signal transduction, cytoskeletal regulation.<br>
</em>   <strong>PSMC6 (Proteasome 26S Subunit, ATPase 6):</strong> This gene encodes a subunit of the 19S regulatory particle of the 26S proteasome. The proteasome is a multi-catalytic proteinase complex responsible for the degradation of ubiquitinated proteins, a crucial process for protein homeostasis, cell cycle control, and antigen presentation. <strong>Role:</strong> Protein degradation, proteostasis.<br>
<em>   <strong>WNK1 (WNK Lysine Deficient Protein Kinase 1):</strong> This gene encodes a serine/threonine protein kinase involved in regulating ion transport, particularly in the kidney, but also with broader roles in cell volume regulation and blood pressure. While known for renal function, WNK1 has ubiquitous expression and diverse cellular roles. <strong>Role:</strong> Kinase activity, ion transport regulation, cell signaling.<br>
</em>   <strong>ERI3 (Eri3 Exoribonuclease Family Member):</strong> This gene encodes a protein with exoribonuclease activity, suggesting a role in RNA degradation and processing. <strong>Role:</strong> RNA metabolism, degradation.<br>
<br>
<strong>Summary of Functional Markers:</strong> The genes listed are overwhelmingly involved in core cellular machinery and housekeeping functions: mRNA processing, protein glycosylation, membrane trafficking, protein degradation, kinase signaling, and RNA degradation. These are fundamental processes required by virtually all living cells.<br>
<br>
---<br>
<br>
<h4>Step 2: List the Key Cell Type Markers</h4>
<br>
Based on the functional analysis above, <strong>none of the provided genes are recognized as specific, canonical markers for a particular differentiated cell type in the large intestine or any other tissue.</strong> They are all broadly expressed &quot;housekeeping-like&quot; genes or genes involved in fundamental cellular processes.<br>
<br>
<em>   <strong>No specific large intestine epithelial markers:</strong> Genes like </em>MUC2<em> (goblet cells), </em>CHGA<em> (enteroendocrine cells), </em>LGR5<em> (stem cells), </em>KRT20<em> (colonocytes), </em>LYZ<em> (Paneth cells, though rare in large intestine), or </em>CD68<em> (macrophages), </em>CD3D<em> (T cells), </em>CD79A<em> (B cells), </em>ACTA2<em> (smooth muscle cells), </em>PECAM1<em> (endothelial cells) are absent.<br>
</em>   <strong>No specific immune cell markers.</strong><br>
<em>   <strong>No specific stromal cell markers.</strong><br>
<br>
<strong>Conclusion for Step 2:</strong> There are no &quot;key cell type markers&quot; in this list that would directly point to a specific differentiated cell type.<br>
<br>
---<br>
<br>
<h4>Step 3: Cross-reference Known Databases</h4>
<br>
Given the nature of these genes, cross-referencing databases like the Human Protein Atlas, GTEx, and single-cell atlases (e.g., Tabula Sapiens, Human Cell Atlas) for expression patterns is crucial.<br>
<br>
</em>   <strong>Human Protein Atlas (HPA):</strong><br>
<em>   <strong>CPSF3L:</strong> Detected in virtually all tissues and cell types, with high expression in many.<br>
</em>   <strong>ALG5:</strong> Detected in virtually all tissues and cell types, with high expression in many.<br>
<em>   <strong>CYTH2:</strong> Detected in virtually all tissues and cell types, with high expression in many.<br>
</em>   <strong>PSMC6:</strong> Detected in virtually all tissues and cell types, with high expression in many.<br>
<em>   <strong>WNK1:</strong> Ubiquitously expressed, with higher levels in kidney, brain, and heart, but present in colon.<br>
</em>   <strong>ERI3:</strong> Detected in virtually all tissues and cell types, with high expression in many.<br>
<em>   <strong>GTEx Portal:</strong> Confirms broad expression across a wide range of tissues for all these genes.<br>
</em>   <strong>Single-cell RNA-seq atlases (e.g., Tabula Sapiens, Human Cell Atlas data for large intestine):</strong> When examining these genes in large intestine datasets, they consistently show ubiquitous expression across most, if not all, major cell types (epithelial, immune, stromal). Their expression levels are generally high, reflecting their essential roles.<br>
<br>
<strong>Cross-referencing Conclusion:</strong> The database searches confirm that these genes are broadly expressed &quot;housekeeping&quot; or essential cellular function genes. Their high expression in a cluster is not indicative of a specific differentiated cell type but rather reflects the general metabolic activity and viability of the cells within that cluster.<br>
<br>
---<br>
<br>
<h4>Step 4: Determine the Most Probable General Cell Type</h4>
<br>
Based on the ubiquitous and fundamental nature of the listed markers, the most probable general cell type is <strong>&quot;Pan-cellular / Undifferentiated / Metabolically Active Cells.&quot;</strong><br>
<br>
This is not a specific differentiated cell type but rather a description of a cluster that is defined by the high expression of genes involved in core cellular maintenance and function, rather than specialized roles. This pattern is often observed in:<br>
<br>
<ul>
<li> <strong>Undifferentiated or Proliferating Cells:</strong> Cells that are actively dividing and growing often have high expression of genes related to basic cellular machinery.</li>
<li> <strong>Viable Cells in General:</strong> Any healthy, metabolically active cell will express these genes at high levels.</li>
<li> <strong>A Mixed Population:</strong> If the cluster is not well-resolved, it might contain various cell types that all express these housekeeping genes highly.</li>
<li> <strong>A &quot;Housekeeping&quot; Cluster:</strong> Sometimes, unsupervised clustering can group cells based on general metabolic activity rather than specific lineage markers, especially if the dataset has a strong &quot;housekeeping&quot; component.</li>
</ul>
<br>
Given the context of scRNA-seq, where clusters are expected to represent distinct cell populations, the high expression of these general metabolic genes <em>without</em> any specific lineage markers strongly suggests that this cluster represents a population of cells that are primarily defined by their active basal cellular processes.<br>
<br>
---<br>
<br>
<h4>Step 5: Identify the Top 3 Most Probable Sub Cell Types</h4>
<br>
This is the most challenging step given the provided markers, as they do not offer strong discriminatory power for specific subtypes. However, I will infer based on common biological scenarios in scRNA-seq and the <em>absence</em> of specific markers.<br>
<br>
<ul>
<li> <strong>Most Likely: Undifferentiated/Progenitor Cells (e.g., Epithelial Stem/Progenitor Cells or Mesenchymal Stem Cells):</strong></li>
</ul>
<em>   <strong>Reasoning:</strong> Cells that are actively dividing and maintaining a progenitor state often exhibit high expression of fundamental metabolic genes without yet committing to a highly specialized, differentiated phenotype. In the large intestine, this could include epithelial stem cells (e.g., LGR5+ cells, although LGR5 is not here) or early progenitor cells that are still highly metabolically active and preparing for differentiation. Mesenchymal stem cells in the lamina propria could also fit this profile. The lack of specific differentiation markers supports this.<br>
</em>   <strong>Caveat:</strong> Without specific progenitor markers (e.g., <em>LGR5</em>, <em>OLFM4</em> for epithelial stem cells, or <em>CD44</em>, <em>CD90</em> for mesenchymal stem cells), this remains an inference based on the <em>absence</em> of differentiation.<br>
<br>
<ul>
<li> <strong>Second Most Likely: Highly Metabolically Active Differentiated Cells (e.g., Enterocytes or Goblet Cells in a basal state):</strong></li>
</ul>
<em>   <strong>Reasoning:</strong> Even fully differentiated cells, especially those with high metabolic demands like enterocytes (for absorption) or goblet cells (for mucin production), will express these housekeeping genes at high levels. If the cluster represents a population of these cells that are primarily characterized by their basal metabolic activity rather than their most unique functional markers, this could be the case.<br>
</em>   <strong>Caveat:</strong> This would imply that the <em>specific</em> markers for these differentiated cells (e.g., <em>KRT20</em>, <em>FABP1</em> for enterocytes; <em>MUC2</em>, <em>TFF3</em> for goblet cells) are either not highly expressed in this particular cluster (perhaps due to a specific state or technical reasons) or are simply not among the top 6 markers provided. Given the ranking, it&#x27;s less likely to be a highly specific differentiated cell type if its defining markers are not even in the top 6.<br>
<br>
<ul>
<li> <strong>Third Most Likely: General Stromal Cells (e.g., Fibroblasts or Pericytes):</strong></li>
</ul>
<em>   <strong>Reasoning:</strong> Stromal cells, such as fibroblasts, are abundant in the large intestine lamina propria and submucosa. They are metabolically active, synthesizing extracellular matrix components and providing structural support. They also express a wide array of housekeeping genes.<br>
</em>   <strong>Caveat:</strong> Similar to the above, specific stromal markers (e.g., <em>COL1A1</em>, <em>DCN</em>, <em>PDGFRA</em> for fibroblasts; <em>RGS5</em>, <em>ACTA2</em> for pericytes) are absent. While these cells are metabolically active, the provided markers are not specific enough to definitively point to them over other cell types.<br>
<br>
<strong>Most Likely Subtype Based on Markers:</strong> Given the extremely generic nature of the markers, the most conservative and probable interpretation is that this cluster represents a population of <strong>Undifferentiated/Progenitor Cells</strong> or simply <strong>Metabolically Active Cells</strong> that are not yet strongly committed to a specific, highly specialized lineage, or a cluster where the defining features are general cellular processes rather than specific functions. Without any lineage-specific markers, it&#x27;s difficult to be more precise. If forced to choose the <em>most likely</em> specific subtype from the three, I would lean towards <strong>Undifferentiated/Progenitor Cells</strong> because their primary characteristic is often high metabolic activity and general cellular machinery expression before specialization.<br>
<br>
---<br>
<br>
<h4>Step 6: Provide a Concise Summary of Your Analysis</h4>
<br>
The provided marker list (CPSF3L, ALG5, CYTH2, PSMC6, WNK1, ERI3) consists entirely of genes involved in fundamental, ubiquitous cellular processes such as mRNA processing, protein glycosylation, membrane trafficking, protein degradation, kinase signaling, and RNA metabolism. These genes are widely expressed across nearly all cell types and tissues, functioning as essential &quot;housekeeping&quot; or core metabolic genes.<br>
<br>
There are no specific, canonical cell type markers for any differentiated cell type found in the large intestine (e.g., epithelial, immune, or stromal cells) within this list. Cross-referencing with known databases confirms their broad expression patterns.<br>
<br>
Therefore, the most probable general cell type for this cluster is <strong>Pan-cellular / Undifferentiated / Metabolically Active Cells</strong>. This cluster is defined by its high basal cellular activity rather than a specialized function.<br>
<br>
Based on the absence of specific differentiation markers and the high expression of core metabolic genes, the top three most probable sub-cell types are:<br>
<br>
<ul>
<li> <strong>Undifferentiated/Progenitor Cells:</strong> Actively dividing cells with high metabolic demands, not yet committed to a specific lineage.</li>
<li> <strong>Highly Metabolically Active Differentiated Cells:</strong> Differentiated cells (e.g., enterocytes, goblet cells) whose primary defining feature in this cluster is their high basal metabolic activity rather than their unique functional markers.</li>
<li> <strong>General Stromal Cells (e.g., Fibroblasts):</strong> Metabolically active cells providing structural support, also characterized by high expression of housekeeping genes.</li>
</ul>
<br>
The most likely specific subtype, given the generic nature of the markers, is <strong>Undifferentiated/Progenitor Cells</strong>, as their primary transcriptional signature often revolves around fundamental cellular processes before specialization. However, without any specific lineage markers, this annotation remains a strong inference based on exclusion.<br>
<br>
FINAL ANNOTATION COMPLETED<br>
                </div>
            </div>

            <div class="modal-section validator-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                    Validation Check
                </h3>
                <div class="section-content">
                    
        <div class="validation-status passed">
            <span class="status-icon">&#10004;</span>
            <span class="status-text">Validation PASSED</span>
        </div>
        <div class="validator-content">Validation result: VALIDATION PASSED</div>
        
                </div>
            </div>

            <div class="modal-section formatting-section">
                <h3 class="section-title">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="16" y1="13" x2="8" y2="13"></line>
                        <line x1="16" y1="17" x2="8" y2="17"></line>
                        <polyline points="10 9 9 9 8 9"></polyline>
                    </svg>
                    Structured Summary
                </h3>
                <div class="section-content">
                    
            <div class="json-summary">
                <div class="summary-field">
                    <span class="field-label">Main Cell Type:</span>
                    <span class="field-value main-type">Pan-cellular / Undifferentiated / Metabolically Active Cells</span>
                </div>
                <div class="summary-field">
                    <span class="field-label">Sub Cell Types:</span>
                    <ul class="type-list">
                        <li>Undifferentiated/Progenitor Cells</li><li>Highly Metabolically Active Differentiated Cells</li><li>General Stromal Cells</li>
                    </ul>
                </div>
                <div class="summary-field">
                    <span class="field-label">Possible Mixed Types:</span>
                    <ul class="type-list">
                        <li class="empty">None identified</li>
                    </ul>
                </div>
            </div>
            
                </div>
            </div>

            
        </div>
    </div>
    
        </div>
    </div>

    <script>

    let currentModalIndex = null;

    function openModal(index) {
        const overlay = document.getElementById('modal-overlay');
        const allContents = document.querySelectorAll('.modal-content');

        allContents.forEach(c => c.classList.remove('active'));

        const content = document.getElementById('modal-content-' + index);
        if (content) {
            content.classList.add('active');
            overlay.classList.add('active');
            currentModalIndex = index;
            document.body.style.overflow = 'hidden';
        }
    }

    function closeModal() {
        const overlay = document.getElementById('modal-overlay');
        overlay.classList.remove('active');
        currentModalIndex = null;
        document.body.style.overflow = '';
    }

    // Close modal on overlay click
    document.getElementById('modal-overlay').addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal();
        }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && currentModalIndex !== null) {
            closeModal();
        }
    });

    // Search functionality
    function filterCards() {
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        const tissueFilter = document.getElementById('filter-tissue').value;
        const speciesFilter = document.getElementById('filter-species').value;
        const modelFilter = document.getElementById('filter-model').value;
        const providerFilter = document.getElementById('filter-provider').value;

        const cards = document.querySelectorAll('.cluster-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const text = card.textContent.toLowerCase();
            const tissue = card.dataset.tissue;
            const species = card.dataset.species;
            const model = card.dataset.model;
            const provider = card.dataset.provider;

            const matchesSearch = searchTerm === '' || text.includes(searchTerm);
            const matchesTissue = tissueFilter === '' || tissue === tissueFilter;
            const matchesSpecies = speciesFilter === '' || species === speciesFilter;
            const matchesModel = modelFilter === '' || model === modelFilter;
            const matchesProvider = providerFilter === '' || provider === providerFilter;

            if (matchesSearch && matchesTissue && matchesSpecies && matchesModel && matchesProvider) {
                card.style.display = '';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        // Show/hide no results message
        const noResults = document.getElementById('no-results');
        if (noResults) {
            noResults.style.display = visibleCount === 0 ? 'block' : 'none';
        }

        // Update visible count
        const countEl = document.getElementById('visible-count');
        if (countEl) {
            countEl.textContent = visibleCount;
        }
    }

    // Clear filters
    function clearFilters() {
        document.getElementById('search-input').value = '';
        document.getElementById('filter-tissue').value = '';
        document.getElementById('filter-species').value = '';
        document.getElementById('filter-model').value = '';
        document.getElementById('filter-provider').value = '';
        filterCards();
    }

    // Export to PDF (print)
    function exportToPDF() {
        window.print();
    }

    // Initialize search input listener
    document.getElementById('search-input').addEventListener('input', filterCards);
    
    </script>
</body>
</html>